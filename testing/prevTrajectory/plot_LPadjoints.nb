(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     62597,       1492]
NotebookOptionsPosition[     61235,       1461]
NotebookOutlinePosition[     61636,       1477]
CellTagsIndexPosition[     61593,       1474]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.796733338996614*^9, 3.796733347956118*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"b60bcda4-b1a2-4102-8600-9d2e8b60307c"],

Cell[BoxData["\<\"C:\\\\msys64\\\\home\\\\wtdai\\\\HASTE\\\\testing\\\\\
prevTrajectory\"\>"], "Output",
 CellChangeTimes->{3.796733348625154*^9, 3.7969797290065126`*^9, 
  3.797065661754725*^9, 3.7970750340799427`*^9, 3.797075084353047*^9, 
  3.7970783017569265`*^9, 3.797079246108926*^9, 3.7970894149564557`*^9, 
  3.797150961316888*^9, 3.797154658849142*^9, 3.7971844386244183`*^9, 
  3.797185765073704*^9},
 CellLabel->
  "Out[193]=",ExpressionUUID->"937e9891-6b5d-4208-a8c1-970358e3f643"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Edetect", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "8"}]]}], ",", 
     RowBox[{"2.5", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "8"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"2", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"3", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"4", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"5", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"6", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"8", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ",", 
     RowBox[{"3.16", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointfiles", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<prevLPemissionPoints_e01.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e02.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e03.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e04.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e05.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e06.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e07.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e08.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e09.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e10.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e11.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e12.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e13.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e14.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e15.tst\>\""}], "\[IndentingNewLine]", "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tracefiles", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<prevLPemissionPoints_e01_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e02_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e03_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e04_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e05_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e06_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e07_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e08_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e09_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e10_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e11_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e12_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e13_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e14_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e15_traces.tst\>\""}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rMoon", "=", "1737"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aMoon", "=", 
   RowBox[{"0.3844", " ", 
    SuperscriptBox["10", "6"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mMoon", "=", 
   RowBox[{"0.07346", " ", 
    SuperscriptBox["10", "24"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mEarth", "=", 
   RowBox[{"5.9724", " ", 
    SuperscriptBox["10", "24"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rSOImoon", "=", 
   RowBox[{"aMoon", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["mMoon", "mEarth"], ")"}], 
     RowBox[{"2", "/", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "250"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vp", ",", "vv"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Options", "[", 
     RowBox[{"Graphics3D", ",", 
      RowBox[{"{", 
       RowBox[{"ViewPoint", ",", "ViewVertical"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ReadList", "[", 
      RowBox[{
       RowBox[{"pointfiles", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "Number", ",", 
       RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pointfiles", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"ReadList", "[", 
        RowBox[{
         RowBox[{"tracefiles", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "Number", ",", 
         RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}], ",", "11"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "tracefiles", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.797066338090611*^9, 3.7970664314961925`*^9}, {
  3.797066487031848*^9, 3.7970666114325123`*^9}, {3.7970668590805407`*^9, 
  3.7970669756878734`*^9}, {3.7970739363531675`*^9, 3.7970739541600037`*^9}, {
  3.797074015971945*^9, 3.797074081113426*^9}, {3.797076621741613*^9, 
  3.7970766334342833`*^9}, {3.79707925341984*^9, 3.7970792540248213`*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"9dbb198b-91d6-48fd-ba27-3ecc46c43c0a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"origin", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dhat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"9", ";;", "11"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nhat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"12", ";;", "14"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fhat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"15", ";;", "17"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rsat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"3", ";;", "5"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1s", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"5", ";;", "7"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1s", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"8", ";;", "10"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrDs", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2s", "=", 
   RowBox[{"b", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "11", ",", 
      RowBox[{"5", ";;", "7"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"traces", "=", 
   RowBox[{"b", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", ";;", ",", 
      RowBox[{"2", ";;", "4"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lenA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"a", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lenB", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"b", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "b", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trips", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"traces", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rMaxs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"traces", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", "1"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"lenB", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "tracefiles", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7970748535218735`*^9, 3.7970749692772837`*^9}, {
   3.7970751594538703`*^9, 3.7970752181565356`*^9}, {3.7970753138712664`*^9, 
   3.797075354588852*^9}, 3.7970754513753376`*^9, {3.7970755753732796`*^9, 
   3.79707562177192*^9}, {3.797075656523794*^9, 3.7970757056440735`*^9}, {
   3.7970757693886313`*^9, 3.7970757721869235`*^9}, {3.7970758899340196`*^9, 
   3.7970759073712287`*^9}, {3.797075945530746*^9, 3.79707599785165*^9}, {
   3.7970760683465786`*^9, 3.7970761089552736`*^9}, {3.7970762133900356`*^9, 
   3.7970762322832713`*^9}, {3.797076359950075*^9, 3.7970763607303324`*^9}, {
   3.7970764461566415`*^9, 3.797076448378286*^9}, {3.7970764867790146`*^9, 
   3.7970765930340805`*^9}, {3.797076643390664*^9, 3.797076661770734*^9}, {
   3.7970776306837053`*^9, 3.7970776309542093`*^9}, {3.7970779584086714`*^9, 
   3.7970779698806486`*^9}, {3.7970791654496346`*^9, 3.7970791846631827`*^9}, 
   3.7970792327141314`*^9},
 CellLabel->
  "In[206]:=",ExpressionUUID->"9278cff5-a626-40ea-b990-31a59825014f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"j", ">", "k"}], ",", 
      RowBox[{"k", "=", "j"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"k", ">", 
       RowBox[{"lenB", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}], ",", 
      RowBox[{"k", "=", 
       RowBox[{"lenB", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"r", ">", 
       RowBox[{"rMaxs", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}], ",", 
      RowBox[{"r", "=", 
       RowBox[{"rMaxs", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "1", ",", 
                    RowBox[{"3", ";;", "5"}]}], "]"}], "]"}], "+", 
                  RowBox[{"p", " ", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", 
                    RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
                  "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}], ",", 
                  RowBox[{"5", ";;", "7"}]}], "]"}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Directive", "[", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"PointSize", "[", "0.001", "]"}]}], "]"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", 
                  RowBox[{"PointSize", "[", "0.004", "]"}]}], "]"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", "3"}], "]"}]}], 
             ",", 
             RowBox[{"BoxRatios", "\[Rule]", "1"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "720"}], ",", 
             RowBox[{"ViewPoint", "\[Rule]", 
              RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", 
             RowBox[{"ViewVertical", "\[Rule]", 
              RowBox[{"Dynamic", "[", "vv", "]"}]}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<En at detector = \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"Edetect", "[", 
                  RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], 
                "]"}], "<>", "\"\< MeV\>\""}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"Rsat", ",", 
                 RowBox[{"Rsat", "+", 
                  RowBox[{".15", "r", " ", "Dhat"}]}]}], "}"}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"Rsat", ",", 
                 RowBox[{"Rsat", "+", 
                  RowBox[{".15", "r", " ", "Nhat"}]}]}], "}"}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"Rsat", ",", 
                 RowBox[{"Rsat", "+", 
                  RowBox[{".15", "r", " ", "Fhat"}]}]}], "}"}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", 
              RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"origin", ",", 
                 RowBox[{"0.9", "r", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", 
              RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"origin", ",", 
                 RowBox[{"0.9", "r", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", 
              RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"origin", ",", 
                 RowBox[{"0.9", "r", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"White", ",", 
              RowBox[{"Opacity", "[", "1", "]"}], ",", 
              RowBox[{"Sphere", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "rMoon"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Green", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"traces", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"j", ";;", "k"}]}], "]"}], "]"}], "]"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{"Orange", ",", 
                RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "+", 
                    RowBox[{".05", "r", " ", 
                    RowBox[{"v1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}]}]}]}], "}"}], 
                 "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"j", "+", "1"}], ",", 
               RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", 
                    RowBox[{"2", ";;"}], ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"PlotStyle", "->", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Gray", ",", 
                    RowBox[{"PointSize", "[", "0.007", "]"}]}], "]"}]}], ",", 
                  
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
                  RowBox[{"BoxRatios", "\[Rule]", "1"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "360"}], ",", 
                  RowBox[{"ViewPoint", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", 
                  RowBox[{"ViewVertical", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vv", "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"Black", ",", 
                   RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", "Dhat"}], "}"}], "]"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"Blue", ",", 
                   RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", "Nhat"}], "}"}], "]"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"Red", ",", 
                   RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", "Fhat"}], "}"}], "]"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Green", "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"arrDs", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Green", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"arrDs", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", "origin"}], 
                    "}"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"v2s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}]}], ",", "origin"}],
                     "}"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}]}], 
                 "]"}]}], "\[IndentingNewLine]", "]"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", 
                    RowBox[{"2", ";;"}], ",", 
                    RowBox[{"5", ";;", "7"}]}], "]"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.007", "]"}]}], "]"}], 
                    "}"}]}], ",", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"1.25", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "3"}], 
                    "]"}]}], ",", 
                  RowBox[{"BoxRatios", "\[Rule]", "1"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "360"}], ",", 
                  RowBox[{"ViewPoint", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", 
                  RowBox[{"ViewVertical", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vv", "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"LightGray", ",", 
                   RowBox[{"Arrowheads", "[", ".03", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", 
                    RowBox[{"1.2", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"LightGray", ",", 
                   RowBox[{"Arrowheads", "[", ".03", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", 
                    RowBox[{"1.2", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"LightGray", ",", 
                   RowBox[{"Arrowheads", "[", ".03", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", 
                    RowBox[{"1.2", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"White", ",", 
                   RowBox[{"Opacity", "[", "1", "]"}], ",", 
                   RowBox[{"Sphere", "[", 
                    RowBox[{"origin", ",", "rMoon"}], "]"}]}], "}"}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{"Orange", ",", 
                    RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "+", 
                    RowBox[{".1", "rMoon", " ", 
                    RowBox[{"v1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}]}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "}"}]}], "\[IndentingNewLine]", 
            "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"False", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"False", ",", "True"}], "}"}]}], "}"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "}"}], ",", 
      RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"En", ",", "1"}], "}"}], ",", "1", ",", 
     RowBox[{"Length", "[", "lenA", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}], ",", "1", ",", 
     RowBox[{"lenB", "[", 
      RowBox[{"[", "En", "]"}], "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Max", "[", "lenB", "]"}]}], "}"}], ",", "j", ",", 
     RowBox[{"Max", "[", "lenB", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "rSOImoon"}], "}"}], ",", 
     RowBox[{"Norm", "[", "Rsat", "]"}], ",", "rSOImoon", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"rSOImoon", "-", 
        RowBox[{"Norm", "[", "Rsat", "]"}]}], ")"}], "/", "100"}], ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0F1IUwEYxvFloCEJJiWjZjUdqzBvQlNkQiWFhh80+lhbSjUHk0Blnrwo
OCmVHrQcpk762CAzkjwXYsJSQiQtLWWailiBUK41NPFmYDWT9j8XLz94bh6e
V3u10miLUqlUByKHwTdbki6c/nX8d9OS4uQhnwFPXU/Pwcs7Cotxf7XHhMPH
zpXikTrpCk63hK7hoGe6Ah8c9NVjcm6ihJqzI+1YqdE/xAb7nT7stfcPKH1/
895jfVr5GNZ2GObQ9c39GX0rll2miP7mKR2u/viSif3xgVy0vu4xok24V4Kb
S9VdKL5YUexp0svomUr34rvsso9oPjqq2NYpr6HO5g2hutv0B7vvOsNK/jI1
+mLEAmk2Bj0DYyn4aNuwDjsFpwULv8aVoX/PYQcG0qIF1CfdbsT5rbIL++b2
uVFtz3mKhuC/MN4c8W5g7GNZZeavjWuKWdvbY3FZ/SQOn1utCVir/7Abxb3m
IhzMCxfj+oTWhMGF+6V43l1XhTUnUwSsytaImNFQIeGQ42cr3rAEXLjzRP4z
jDIWKX56Ne7FrtkNRaklNCpGjHdqx7E30zePM+WXFlGckb/j26xNPyYsZzhu
sX/9jID/ARSJL/8=
  "],
 CellLabel->
  "In[220]:=",ExpressionUUID->"15bf1efb-2181-49b5-b420-56479a96a331"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 1, $CellContext`j$$ = 
    156, $CellContext`k$$ = 234, $CellContext`r$$ = 2841.935959869609, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`En$$], 1}, 1, 15, 1}, {{
       Hold[$CellContext`j$$], 1}, 1, 
      Dynamic[
       Part[$CellContext`lenB, $CellContext`En$$]], 1}, {{
       Hold[$CellContext`k$$], 782}, 
      Dynamic[$CellContext`j$$], 782, 1}, {{
       Hold[$CellContext`r$$], 66182.65628676258}, 2841.9359598696087`, 
      66182.65628676258, 633.4072032689297}}, Typeset`size$$ = {
    1103., {369., 375.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`En$$ = 1, $CellContext`j$$ = 
        1, $CellContext`k$$ = 782, $CellContext`r$$ = 66182.65628676258}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (
       If[$CellContext`j$$ > $CellContext`k$$, $CellContext`k$$ = \
$CellContext`j$$]; 
       If[$CellContext`k$$ > 
         Part[$CellContext`lenB, $CellContext`En$$], $CellContext`k$$ = 
         Part[$CellContext`lenB, $CellContext`En$$]]; 
       If[$CellContext`r$$ > 
         Part[$CellContext`rMaxs, $CellContext`En$$], $CellContext`r$$ = 
         Part[$CellContext`rMaxs, $CellContext`En$$]]; Grid[{{
           Show[
            ListPointPlot3D[{
              Table[Part[$CellContext`a, $CellContext`En$$, 1, 
                 Span[3, 5]] + $CellContext`p 
                Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                  Span[1, 3]], {$CellContext`i, 2, 
                Length[
                 Part[$CellContext`a, $CellContext`En$$, 
                  Span[2, All]]], 1}], 
              Part[$CellContext`a, $CellContext`En$$, 
               Span[2, All], 
               Span[5, 7]]}, PlotStyle -> {
               Directive[Gray, 
                PointSize[0.001]], 
               Directive[Black, 
                PointSize[0.004]]}, PlotRange -> 
             Table[{-$CellContext`r$$, $CellContext`r$$}, 3], BoxRatios -> 1, 
             ImageSize -> 720, ViewPoint -> Dynamic[$CellContext`vp], 
             ViewVertical -> Dynamic[$CellContext`vv], PlotLabel -> 
             StringJoin["En at detector = ", 
               ToString[
                Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
               " MeV"]], 
            Graphics3D[{Black, 
              Arrowheads[0.01], 
              
              Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
                0.15 $CellContext`r$$ $CellContext`Dhat}]}], 
            Graphics3D[{Blue, 
              Arrowheads[0.01], 
              
              Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
                0.15 $CellContext`r$$ $CellContext`Nhat}]}], 
            Graphics3D[{Red, 
              Arrowheads[0.01], 
              
              Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
                0.15 $CellContext`r$$ $CellContext`Fhat}]}], 
            Graphics3D[{LightGray, 
              Arrowheads[0.02], 
              Arrow[{$CellContext`origin, 0.9 $CellContext`r$$ {1, 0, 0}}]}], 
            
            Graphics3D[{LightGray, 
              Arrowheads[0.02], 
              Arrow[{$CellContext`origin, 0.9 $CellContext`r$$ {0, 1, 0}}]}], 
            
            Graphics3D[{LightGray, 
              Arrowheads[0.02], 
              Arrow[{$CellContext`origin, 0.9 $CellContext`r$$ {0, 0, 1}}]}], 
            
            Graphics3D[{White, 
              Opacity[1], 
              Sphere[{0, 0, 0}, $CellContext`rMoon]}], 
            Graphics3D[{Green, 
              Line[
               Part[$CellContext`traces, $CellContext`En$$, 
                Span[$CellContext`j$$, $CellContext`k$$]]]}], 
            Table[
             Graphics3D[{Orange, 
               Arrowheads[0.01], 
               Arrow[{
                 Part[$CellContext`r1s, $CellContext`En$$, $CellContext`i], 
                 Part[$CellContext`r1s, $CellContext`En$$, $CellContext`i] + 
                 0.05 $CellContext`r$$ 
                  Part[$CellContext`v1s, $CellContext`En$$, \
$CellContext`i]}]}], {$CellContext`i, $CellContext`j$$ + 1, $CellContext`k$$ + 
              1, 1}]], 
           Grid[{{
              Show[
               ListPointPlot3D[
                Part[$CellContext`a, $CellContext`En$$, 
                 Span[2, All], 
                 Span[1, 3]], PlotStyle -> Directive[Gray, 
                  PointSize[0.007]], PlotRange -> {-1, 1}, BoxRatios -> 1, 
                ImageSize -> 360, ViewPoint -> Dynamic[$CellContext`vp], 
                ViewVertical -> Dynamic[$CellContext`vv]], 
               Graphics3D[{Black, 
                 Arrowheads[0.02], 
                 Arrow[{$CellContext`origin, $CellContext`Dhat}]}], 
               Graphics3D[{Blue, 
                 Arrowheads[0.02], 
                 Arrow[{$CellContext`origin, $CellContext`Nhat}]}], 
               Graphics3D[{Red, 
                 Arrowheads[0.02], 
                 Arrow[{$CellContext`origin, $CellContext`Fhat}]}], 
               Table[
                Graphics3D[{
                  Darker[Green], 
                  PointSize[0.01], 
                  Point[
                   
                   Part[$CellContext`arrDs, $CellContext`En$$, \
$CellContext`i]]}], {$CellContext`i, $CellContext`j$$ + 1, $CellContext`k$$ + 
                 1, 1}], 
               Table[
                Graphics3D[{
                  Darker[Green], 
                  Arrow[{
                    
                    Part[$CellContext`arrDs, $CellContext`En$$, \
$CellContext`i], $CellContext`origin}]}], {$CellContext`i, $CellContext`j$$ + 
                 1, $CellContext`k$$ + 1, 1}], 
               Table[
                Graphics3D[{Green, 
                  
                  Arrow[{-
                    Part[$CellContext`v2s, $CellContext`En$$, \
$CellContext`i], $CellContext`origin}]}], {$CellContext`i, $CellContext`j$$, \
$CellContext`k$$, 1}]]}, {
              Show[
               ListPointPlot3D[
                Part[$CellContext`a, $CellContext`En$$, 
                 Span[2, All], 
                 Span[5, 7]], PlotStyle -> {
                  Directive[Black, 
                   PointSize[0.007]]}, PlotRange -> 
                Table[1.25 $CellContext`rMoon {-1, 1}, 3], BoxRatios -> 1, 
                ImageSize -> 360, ViewPoint -> Dynamic[$CellContext`vp], 
                ViewVertical -> Dynamic[$CellContext`vv]], 
               Graphics3D[{LightGray, 
                 Arrowheads[0.03], 
                 
                 Arrow[{$CellContext`origin, 
                   1.2 $CellContext`rMoon {1, 0, 0}}]}], 
               Graphics3D[{LightGray, 
                 Arrowheads[0.03], 
                 
                 Arrow[{$CellContext`origin, 
                   1.2 $CellContext`rMoon {0, 1, 0}}]}], 
               Graphics3D[{LightGray, 
                 Arrowheads[0.03], 
                 
                 Arrow[{$CellContext`origin, 
                   1.2 $CellContext`rMoon {0, 0, 1}}]}], 
               Graphics3D[{White, 
                 Opacity[1], 
                 Sphere[$CellContext`origin, $CellContext`rMoon]}], 
               Table[
                Graphics3D[{Orange, 
                  Arrowheads[0.02], 
                  Arrow[{
                    Part[$CellContext`r1s, $CellContext`En$$, $CellContext`i],
                     Part[$CellContext`r1s, $CellContext`En$$, \
$CellContext`i] + 0.1 $CellContext`rMoon 
                    Part[$CellContext`v1s, $CellContext`En$$, \
$CellContext`i]}]}], {$CellContext`i, $CellContext`j$$ + 1, $CellContext`k$$ + 
                 1, 1}]]}}, Frame -> {{False, False}, {False, True}}]}}, 
         Frame -> All]), 
      "Specifications" :> {{{$CellContext`En$$, 1}, 1, 15, 1, 
         Appearance -> {"Open"}}, {{$CellContext`j$$, 1}, 1, 
         Dynamic[
          Part[$CellContext`lenB, $CellContext`En$$]], 1, 
         Appearance -> {"Open"}}, {{$CellContext`k$$, 782}, 
         Dynamic[$CellContext`j$$], 782, 1, 
         Appearance -> {"Open"}}, {{$CellContext`r$$, 66182.65628676258}, 
         2841.9359598696087`, 66182.65628676258, 633.4072032689297, 
         Appearance -> {"Open"}}}, 
      "Options" :> {ContinuousAction -> False, ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1389., {401., 407.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7971857676049156`*^9, {3.797186553995596*^9, 3.797186555532196*^9}},
 CellLabel->
  "Out[220]=",ExpressionUUID->"883337d8-ed12-47d5-ba48-0fac71bc57f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"padding", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"72", ",", "48"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"36", ",", "20"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tofEnpairs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Riffle", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", 
            RowBox[{"2", ";;"}], ",", "4"}], "]"}], "]"}], ",", 
         FractionBox[
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", 
             RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}], "1000"]}], "]"}],
        ",", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "a", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tofDpairs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Riffle", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", 
            RowBox[{"2", ";;"}], ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", 
            RowBox[{"2", ";;"}], ",", "12"}], "]"}], "]"}]}], "]"}], ",", 
       "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "a", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Overlay", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListLogLogPlot", "[", 
        RowBox[{
         RowBox[{"tofEnpairs", "[", 
          RowBox[{"[", "En", "]"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Blue", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Black"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<En [keV]\>\"", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<tof [s]\>\"", ",", 
              RowBox[{"\"\<En at detector = \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"Edetect", "[", 
                  RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], 
                "]"}], "<>", "\"\< MeV\>\""}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", "padding"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLogLogPlot", "[", 
        RowBox[{
         RowBox[{"tofDpairs", "[", 
          RowBox[{"[", "En", "]"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"False", ",", "True"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", "Red"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", "\"\<D-factor\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", "padding"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"En", ",", "1", ",", 
     RowBox[{"Length", "[", "a", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.797089445002349*^9, 3.7970894801687775`*^9}, {
   3.7970896113717327`*^9, 3.7970896274193573`*^9}, {3.7970900255486903`*^9, 
   3.797090145224023*^9}, {3.7970922837369566`*^9, 3.7970923058457174`*^9}, {
   3.797092398776623*^9, 3.797092485637523*^9}, {3.797092533688526*^9, 
   3.79709253840524*^9}, {3.797092604152244*^9, 3.7970926093811665`*^9}, {
   3.7970926582802835`*^9, 3.7970927721305265`*^9}, {3.797092817463296*^9, 
   3.7970928417485476`*^9}, {3.797092895655408*^9, 3.7970929074608746`*^9}, {
   3.797093095431523*^9, 3.797093237860895*^9}, 3.797093401735253*^9, {
   3.797093432116596*^9, 3.7970936641798058`*^9}, {3.797093796791472*^9, 
   3.79709391448736*^9}, {3.797093948151861*^9, 3.797094041971673*^9}, {
   3.797151003451092*^9, 3.7971513209178553`*^9}, {3.797151396104431*^9, 
   3.7971514650303354`*^9}, 3.7971515343932514`*^9, {3.797151702757407*^9, 
   3.7971517571732473`*^9}, {3.7971531706787195`*^9, 3.797153170948251*^9}, {
   3.7971547594530306`*^9, 3.7971549033765717`*^9}, {3.797155384958357*^9, 
   3.7971553941872144`*^9}, {3.7971588457705207`*^9, 
   3.7971589573366537`*^9}, {3.7971589907965765`*^9, 3.797159039560944*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"df1190f4-06a7-4325-a642-7fbde80f39ae"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 15, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`En$$], 1, 15, 1}}, Typeset`size$$ = {
    576., {166., 172.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`En$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Overlay[{
         ListLogLogPlot[
          Part[$CellContext`tofEnpairs, $CellContext`En$$], ImageSize -> 
          Large, PlotStyle -> Blue, Frame -> {{True, False}, {True, True}}, 
          FrameTicks -> {{True, False}, {True, False}}, 
          FrameStyle -> {{Blue, None}, {Black, Black}}, 
          FrameLabel -> {{"En [keV]", None}, {"tof [s]", 
             StringJoin["En at detector = ", 
              ToString[
               Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
              " MeV"]}}, ImagePadding -> $CellContext`padding], 
         ListLogLogPlot[
          Part[$CellContext`tofDpairs, $CellContext`En$$], ImageSize -> Large,
           PlotStyle -> Red, Frame -> {{False, True}, {False, False}}, 
          FrameTicks -> True, FrameStyle -> {{None, Red}, {None, None}}, 
          FrameLabel -> {{None, "D-factor"}, {None, None}}, 
          ImagePadding -> $CellContext`padding]}, Alignment -> Center], 
      "Specifications" :> {{$CellContext`En$$, 1, 15, 1, 
         Appearance -> {"Open"}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{627., {226., 232.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7970894524187455`*^9, 3.7970894803367453`*^9}, {
   3.7970896211786995`*^9, 3.7970896275560374`*^9}, 3.7970900434224133`*^9, 
   3.797090145889044*^9, {3.7970922861050825`*^9, 3.7970923066594353`*^9}, 
   3.797092399218995*^9, {3.7970924307375326`*^9, 3.79709248629718*^9}, 
   3.797092539084428*^9, 3.797092610089649*^9, 3.797092676413782*^9, {
   3.797092707113485*^9, 3.797092731977835*^9}, {3.7970927683371305`*^9, 
   3.7970927730304127`*^9}, {3.7970928230481653`*^9, 3.797092842404298*^9}, 
   3.7970929082943563`*^9, {3.797093124240624*^9, 3.797093238715371*^9}, {
   3.797093444864435*^9, 3.7970934560629873`*^9}, 3.7970935153125257`*^9, {
   3.7970935461216087`*^9, 3.7970935676242027`*^9}, {3.797093604909259*^9, 
   3.7970936647569385`*^9}, {3.7970938038377457`*^9, 3.797093866898267*^9}, {
   3.7970938970828447`*^9, 3.7970939151958356`*^9}, {3.79709395977326*^9, 
   3.7970940091777534`*^9}, 3.797094043033663*^9, 3.7971509797214265`*^9, {
   3.797151041333894*^9, 3.7971510691934023`*^9}, {3.7971511489443674`*^9, 
   3.797151187787159*^9}, 3.7971512415946026`*^9, 3.797151321603385*^9, {
   3.797151396908621*^9, 3.797151440427616*^9}, {3.797151758578021*^9, 
   3.797151761658538*^9}, 3.7971531716806655`*^9, {3.7971547615278893`*^9, 
   3.797154777853139*^9}, 3.797154815712409*^9, {3.7971548476928654`*^9, 
   3.797154856782074*^9}, {3.79715489432349*^9, 3.7971549036421933`*^9}, 
   3.7971553944782343`*^9, 3.7971589609947987`*^9, {3.797158992115892*^9, 
   3.797159040185445*^9}, 3.797184447403594*^9, 3.797185773198105*^9},
 CellLabel->
  "Out[224]=",ExpressionUUID->"e05727f5-ab8d-43fa-828d-a5bcaf4a56c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EnIpairs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Riffle", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", 
             RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}], "1000"], ",", 
         FractionBox["2376", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{"En", ",", 
              RowBox[{"2", ";;"}], ",", "12"}], "]"}], "]"}], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{" ", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}], ",", "4"}], "]"}], "]"}]}], 
              "L"]}]]}]]}], "]"}], ",", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "a", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"m1", "\[GreaterEqual]", "m2"}], ",", 
      RowBox[{"m2", "=", 
       RowBox[{"m1", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ListLogLogPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"EnIpairs", "[", 
        RowBox[{"[", "En", "]"}], "]"}], "/.", 
       RowBox[{"L", "\[Rule]", "Ln"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", "m1"], ",", 
           SuperscriptBox["10", "m2"]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<I [n-surface per n-detector]\>\"", ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<En [MeV]\>\"", ",", 
           RowBox[{"\"\<En at detector = \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Edetect", "[", 
               RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], "]"}], 
            "<>", "\"\< MeV\>\""}]}], "}"}]}], "}"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"En", ",", "1", ",", 
     RowBox[{"Length", "[", "a", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ln", ",", "881"}], "}"}], ",", "875", ",", "895", ",", "0.5", 
     ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m1", ",", "9"}], "}"}], ",", "1", ",", "60", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m2", ",", "15"}], "}"}], ",", "1", ",", "60", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Right"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQ7aUxlb/O643jo7mThUD0MqmVYiC6KYtbG0SzCdp5
g2hjr+N+ILosaE4siNb4fDYRRG82C0sH0e/uluaC6IMekXUg+siLJDBdwbVz
Kog2DyxeBqKlXsevA9GVpwzXg2if+7GbwereLt4KoktWeU2tB9IxuovXguip
1habQfTtVWe3g2j7008OgWgFtR+HQbSm54QzIHrmtPuXQPRKD7UHIHrft9tP
QbR3mcQrEB20TRVMu1yoed4ApHfms70A0cvWP3oPou/tm/IBROc0HPsFoiNu
3/gNollVywUbgfT/pwUiILpo5UMJEC30pd0QRP95Zm8Hov/t+e8MorkVzvqA
6HX1Jr4gOqVsy4RmIC1r9g5MP9siMgtEJ5X0gumLPEs/9ILse+b6B0zrHdTs
A9KXl4Rpg2gAeh7VCw==
  "],
 CellLabel->
  "In[225]:=",ExpressionUUID->"62e629e0-eb67-45ec-bb1d-b0a47eb72723"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 7, $CellContext`Ln$$ = 
    881, $CellContext`m1$$ = 9, $CellContext`m2$$ = 15, Typeset`show$$ = True,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`En$$], 1, 15, 1}, {{
       Hold[$CellContext`Ln$$], 881}, 875, 895, 0.5}, {{
       Hold[$CellContext`m1$$], 9}, 1, 60, 1}, {{
       Hold[$CellContext`m2$$], 15}, 1, 60, 1}}, Typeset`size$$ = {
    576., {190., 194.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`En$$ = 1, $CellContext`Ln$$ = 
        881, $CellContext`m1$$ = 9, $CellContext`m2$$ = 15}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (
       If[$CellContext`m1$$ >= $CellContext`m2$$, $CellContext`m2$$ = \
$CellContext`m1$$ + 1]; ListLogLogPlot[
         ReplaceAll[
          
          Part[$CellContext`EnIpairs, $CellContext`En$$], $CellContext`L -> \
$CellContext`Ln$$], ImageSize -> Large, 
         PlotRange -> {All, {10^$CellContext`m1$$, 10^$CellContext`m2$$}}, 
         PlotStyle -> Blue, Frame -> True, 
         FrameTicks -> {{True, False}, {True, False}}, FrameStyle -> Black, 
         FrameLabel -> {{"I [n-surface per n-detector]", None}, {"En [MeV]", 
            StringJoin["En at detector = ", 
             ToString[
              Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
             " MeV"]}}]), 
      "Specifications" :> {{$CellContext`En$$, 1, 15, 1, 
         Appearance -> {"Open"}}, {{$CellContext`Ln$$, 881}, 875, 895, 0.5, 
         Appearance -> {"Open"}}, {{$CellContext`m1$$, 9}, 1, 60, 1, 
         Appearance -> {"Open"}}, {{$CellContext`m2$$, 15}, 1, 60, 1, 
         Appearance -> {"Open"}}}, "Options" :> {ControlPlacement -> Right}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{864., {221., 227.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.797152508392202*^9, 3.797152527299689*^9}, {
   3.7971526203425026`*^9, 3.7971526343486896`*^9}, {3.7971526861493444`*^9, 
   3.797152687712315*^9}, 3.7971527562163873`*^9, 3.7971529886218014`*^9, {
   3.7971530774303107`*^9, 3.797153146547657*^9}, 3.797153199812647*^9, {
   3.797155024362008*^9, 3.7971550401288433`*^9}, 3.7971551082786508`*^9, 
   3.797155184596795*^9, 3.7971552628460455`*^9, {3.7971553472250643`*^9, 
   3.7971553606706457`*^9}, {3.7971556140313635`*^9, 3.7971556316619444`*^9}, 
   3.7971556657566175`*^9, 3.7971576464089575`*^9, 3.797157696994582*^9, 
   3.797157765670745*^9, 3.7971578556532373`*^9, 3.79715801940894*^9, 
   3.7971580526979856`*^9, 3.797158087963541*^9, {3.797158188737336*^9, 
   3.7971582287479353`*^9}, {3.797158279765701*^9, 3.7971582851191287`*^9}, {
   3.797158422837177*^9, 3.7971584328209157`*^9}, 3.797158506456975*^9, 
   3.797163144927005*^9, 3.7971632245405083`*^9, {3.79718444810623*^9, 
   3.797184483730245*^9}, {3.7971848495441675`*^9, 3.797184859059664*^9}, 
   3.797185773884619*^9},
 CellLabel->
  "Out[226]=",ExpressionUUID->"e2deb8b0-a662-4ee2-a174-c05f5946f995"]
}, Open  ]]
},
WindowSize->{2560, 1007},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5bacc4d9-5684-4201-8fb6-89c8d364033d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 253, 5, 28, "Input",ExpressionUUID->"b60bcda4-b1a2-4102-8600-9d2e8b60307c"],
Cell[836, 29, 493, 8, 32, "Output",ExpressionUUID->"937e9891-6b5d-4208-a8c1-970358e3f643"]
}, Open  ]],
Cell[1344, 40, 6586, 167, 869, "Input",ExpressionUUID->"9dbb198b-91d6-48fd-ba27-3ecc46c43c0a"],
Cell[7933, 209, 4472, 131, 276, "Input",ExpressionUUID->"9278cff5-a626-40ea-b990-31a59825014f"],
Cell[CellGroupData[{
Cell[12430, 344, 20525, 472, 941, "Input",ExpressionUUID->"15bf1efb-2181-49b5-b420-56479a96a331"],
Cell[32958, 818, 9482, 210, 827, "Output",ExpressionUUID->"883337d8-ed12-47d5-ba48-0fac71bc57f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42477, 1033, 6298, 155, 200, "Input",ExpressionUUID->"df1190f4-06a7-4325-a642-7fbde80f39ae"],
Cell[48778, 1190, 4040, 69, 477, "Output",ExpressionUUID->"e05727f5-ab8d-43fa-828d-a5bcaf4a56c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52855, 1264, 4486, 120, 226, "Input",ExpressionUUID->"62e629e0-eb67-45ec-bb1d-b0a47eb72723"],
Cell[57344, 1386, 3875, 72, 467, "Output",ExpressionUUID->"e2deb8b0-a662-4ee2-a174-c05f5946f995"]
}, Open  ]]
}
]
*)

