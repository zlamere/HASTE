(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42782,       1037]
NotebookOptionsPosition[     41885,       1014]
NotebookOutlinePosition[     42283,       1030]
CellTagsIndexPosition[     42240,       1027]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.796733338996614*^9, 3.796733347956118*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b60bcda4-b1a2-4102-8600-9d2e8b60307c"],

Cell[BoxData["\<\"C:\\\\msys64\\\\home\\\\wtdai\\\\HASTE\\\\testing\\\\\
prevTrajectory\"\>"], "Output",
 CellChangeTimes->{3.796733348625154*^9, 3.7969797290065126`*^9, 
  3.797065661754725*^9, 3.7970750340799427`*^9, 3.797075084353047*^9, 
  3.7970783017569265`*^9, 3.797079246108926*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"5a6f7076-e7c6-4853-b287-3a9f7261b45a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Edetect", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "8"}]]}], ",", 
     RowBox[{"2.5", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "8"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"2", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"3", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"4", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"5", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"6", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"8", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ",", 
     RowBox[{"3.16", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointfiles", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<prevLPemissionPoints_e01.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e02.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e03.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e04.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e05.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e06.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e07.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e08.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e09.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e10.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e11.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e12.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e13.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e14.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e15.tst\>\""}], "\[IndentingNewLine]", "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tracefiles", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<prevLPemissionPoints_e01_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e02_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e03_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e04_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e05_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e06_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e07_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e08_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e09_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e10_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e11_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e12_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e13_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e14_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e15_traces.tst\>\""}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rMoon", "=", "1737"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aMoon", "=", 
   RowBox[{"0.3844", " ", 
    SuperscriptBox["10", "6"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mMoon", "=", 
   RowBox[{"0.07346", " ", 
    SuperscriptBox["10", "24"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mEarth", "=", 
   RowBox[{"5.9724", " ", 
    SuperscriptBox["10", "24"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rSOImoon", "=", 
   RowBox[{"aMoon", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["mMoon", "mEarth"], ")"}], 
     RowBox[{"2", "/", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "250"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vp", ",", "vv"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Options", "[", 
     RowBox[{"Graphics3D", ",", 
      RowBox[{"{", 
       RowBox[{"ViewPoint", ",", "ViewVertical"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ReadList", "[", 
      RowBox[{
       RowBox[{"pointfiles", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "Number", ",", 
       RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pointfiles", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"ReadList", "[", 
        RowBox[{
         RowBox[{"tracefiles", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "Number", ",", 
         RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}], ",", "11"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "tracefiles", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.797066338090611*^9, 3.7970664314961925`*^9}, {
  3.797066487031848*^9, 3.7970666114325123`*^9}, {3.7970668590805407`*^9, 
  3.7970669756878734`*^9}, {3.7970739363531675`*^9, 3.7970739541600037`*^9}, {
  3.797074015971945*^9, 3.797074081113426*^9}, {3.797076621741613*^9, 
  3.7970766334342833`*^9}, {3.79707925341984*^9, 3.7970792540248213`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"9dbb198b-91d6-48fd-ba27-3ecc46c43c0a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"origin", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dhat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"9", ";;", "11"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nhat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"12", ";;", "14"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fhat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"15", ";;", "17"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rsat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"3", ";;", "5"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1s", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"5", ";;", "7"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1s", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"8", ";;", "10"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrDs", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2s", "=", 
   RowBox[{"b", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "11", ",", 
      RowBox[{"5", ";;", "7"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"traces", "=", 
   RowBox[{"b", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", ";;", ",", 
      RowBox[{"2", ";;", "4"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lenA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"a", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lenB", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"b", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "b", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trips", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"traces", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rMaxs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"traces", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", "1"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"lenB", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "tracefiles", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7970748535218735`*^9, 3.7970749692772837`*^9}, {
   3.7970751594538703`*^9, 3.7970752181565356`*^9}, {3.7970753138712664`*^9, 
   3.797075354588852*^9}, 3.7970754513753376`*^9, {3.7970755753732796`*^9, 
   3.79707562177192*^9}, {3.797075656523794*^9, 3.7970757056440735`*^9}, {
   3.7970757693886313`*^9, 3.7970757721869235`*^9}, {3.7970758899340196`*^9, 
   3.7970759073712287`*^9}, {3.797075945530746*^9, 3.79707599785165*^9}, {
   3.7970760683465786`*^9, 3.7970761089552736`*^9}, {3.7970762133900356`*^9, 
   3.7970762322832713`*^9}, {3.797076359950075*^9, 3.7970763607303324`*^9}, {
   3.7970764461566415`*^9, 3.797076448378286*^9}, {3.7970764867790146`*^9, 
   3.7970765930340805`*^9}, {3.797076643390664*^9, 3.797076661770734*^9}, {
   3.7970776306837053`*^9, 3.7970776309542093`*^9}, {3.7970779584086714`*^9, 
   3.7970779698806486`*^9}, {3.7970791654496346`*^9, 3.7970791846631827`*^9}, 
   3.7970792327141314`*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"9278cff5-a626-40ea-b990-31a59825014f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"j", ">", "k"}], ",", 
      RowBox[{"k", "=", "j"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"k", ">", 
       RowBox[{"lenB", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}], ",", 
      RowBox[{"k", "=", 
       RowBox[{"lenB", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"r", ">", 
       RowBox[{"rMaxs", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}], ",", 
      RowBox[{"r", "=", 
       RowBox[{"rMaxs", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "1", ",", 
                    RowBox[{"3", ";;", "5"}]}], "]"}], "]"}], "+", 
                  RowBox[{"p", " ", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", 
                    RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
                  "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}], ",", 
                  RowBox[{"5", ";;", "7"}]}], "]"}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Directive", "[", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"PointSize", "[", "0.001", "]"}]}], "]"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", 
                  RowBox[{"PointSize", "[", "0.004", "]"}]}], "]"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", "3"}], "]"}]}], 
             ",", 
             RowBox[{"BoxRatios", "\[Rule]", "1"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "720"}], ",", 
             RowBox[{"ViewPoint", "\[Rule]", 
              RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", 
             RowBox[{"ViewVertical", "\[Rule]", 
              RowBox[{"Dynamic", "[", "vv", "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"Rsat", ",", 
                 RowBox[{"Rsat", "+", 
                  RowBox[{".15", "r", " ", "Dhat"}]}]}], "}"}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"Rsat", ",", 
                 RowBox[{"Rsat", "+", 
                  RowBox[{".15", "r", " ", "Nhat"}]}]}], "}"}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"Rsat", ",", 
                 RowBox[{"Rsat", "+", 
                  RowBox[{".15", "r", " ", "Fhat"}]}]}], "}"}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", 
              RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"origin", ",", 
                 RowBox[{"0.9", "r", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", 
              RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"origin", ",", 
                 RowBox[{"0.9", "r", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", 
              RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"origin", ",", 
                 RowBox[{"0.9", "r", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"White", ",", 
              RowBox[{"Opacity", "[", "1", "]"}], ",", 
              RowBox[{"Sphere", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "rMoon"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Green", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"traces", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"j", ";;", "k"}]}], "]"}], "]"}], "]"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{"Orange", ",", 
                RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "+", 
                    RowBox[{".05", "r", " ", 
                    RowBox[{"v1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}]}]}]}], "}"}], 
                 "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"j", "+", "1"}], ",", 
               RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", 
                    RowBox[{"2", ";;"}], ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"PlotStyle", "->", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Gray", ",", 
                    RowBox[{"PointSize", "[", "0.007", "]"}]}], "]"}]}], ",", 
                  
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
                  RowBox[{"BoxRatios", "\[Rule]", "1"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "360"}], ",", 
                  RowBox[{"ViewPoint", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", 
                  RowBox[{"ViewVertical", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vv", "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"Black", ",", 
                   RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", "Dhat"}], "}"}], "]"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"Blue", ",", 
                   RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", "Nhat"}], "}"}], "]"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"Red", ",", 
                   RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", "Fhat"}], "}"}], "]"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Green", "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"arrDs", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Green", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"arrDs", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", "origin"}], 
                    "}"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"v2s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}]}], ",", "origin"}],
                     "}"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}]}], 
                 "]"}]}], "\[IndentingNewLine]", "]"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", 
                    RowBox[{"2", ";;"}], ",", 
                    RowBox[{"5", ";;", "7"}]}], "]"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.007", "]"}]}], "]"}], 
                    "}"}]}], ",", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"1.25", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "3"}], 
                    "]"}]}], ",", 
                  RowBox[{"BoxRatios", "\[Rule]", "1"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "360"}], ",", 
                  RowBox[{"ViewPoint", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", 
                  RowBox[{"ViewVertical", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vv", "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"LightGray", ",", 
                   RowBox[{"Arrowheads", "[", ".03", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", 
                    RowBox[{"1.2", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"LightGray", ",", 
                   RowBox[{"Arrowheads", "[", ".03", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", 
                    RowBox[{"1.2", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"LightGray", ",", 
                   RowBox[{"Arrowheads", "[", ".03", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", 
                    RowBox[{"1.2", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"White", ",", 
                   RowBox[{"Opacity", "[", "1", "]"}], ",", 
                   RowBox[{"Sphere", "[", 
                    RowBox[{"origin", ",", "rMoon"}], "]"}]}], "}"}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{"Orange", ",", 
                    RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "+", 
                    RowBox[{".1", "rMoon", " ", 
                    RowBox[{"v1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}]}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "}"}]}], "\[IndentingNewLine]", 
            "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"False", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"False", ",", "True"}], "}"}]}], "}"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "}"}], ",", 
      RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"En", ",", "1"}], "}"}], ",", "1", ",", 
     RowBox[{"Length", "[", "lenA", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}], ",", "1", ",", 
     RowBox[{"lenB", "[", 
      RowBox[{"[", "En", "]"}], "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Max", "[", "lenB", "]"}]}], "}"}], ",", "j", ",", 
     RowBox[{"Max", "[", "lenB", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "rSOImoon"}], "}"}], ",", 
     RowBox[{"Norm", "[", "Rsat", "]"}], ",", "rSOImoon", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"rSOImoon", "-", 
        RowBox[{"Norm", "[", "Rsat", "]"}]}], ")"}], "/", "100"}], ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0FkowwEABvChRotCaDHn1iL2IleackTIUcsxWxZmNSlbjAdqWa5ljlyT
YytXZHsQaixJOeZqo0mOJ2GWkRflGLLv//D1q+/lqy+yRsIRuZNIJLor0L7l
Flqe/5LxqbonPI0xs2FOc0IarPIrLIYRTVou3EkvFcB4hbIang2910Oj9qwB
Dkebu2FUVpAS0kp2x6CExpyAPeLOVbgiXt8k9r5zD2A3q84E28fZF1B9p7mG
Zgc/kOvyYcDCgK+PN8lw3deWBYUbOg4Uyfoq4d990zyULzoIdSqmHmotCQa4
n1p7DHlJe4Sjs/o3yBAZ3iF1ifsFl7oGnUS/HEuucFmgtHpC7aaJDie9dhhw
VjbIh4W3PrXwISSuEdpYZBlkhnb0wksPvRquXoRrIFWcNgPZ9l8nbNs1/EDK
lJ7Ew6+9b4Qp3mMU+Eyd9oELQqE/bGceBUN5GK8IGnOdxfDjJJIL7Vf9Alim
UUhhSzZdBqWpNDlM7GlQwu3GpxHYyrepYUBm3hx05xQRnq8dGuC89YfwH1Pe
DQk=
  "],
 CellLabel->"In[43]:=",ExpressionUUID->"15bf1efb-2181-49b5-b420-56479a96a331"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 7, $CellContext`j$$ = 
    1, $CellContext`k$$ = 1, $CellContext`r$$ = 2841.935959869609, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`En$$], 1}, 1, 15, 1}, {{
       Hold[$CellContext`j$$], 1}, 1, 
      Dynamic[
       Part[$CellContext`lenB, $CellContext`En$$]], 1}, {{
       Hold[$CellContext`k$$], 782}, 
      Dynamic[$CellContext`j$$], 782, 1}, {{
       Hold[$CellContext`r$$], 66182.65628676258}, 2841.9359598696087`, 
      66182.65628676258, 633.4072032689297}}, Typeset`size$$ = {
    1103., {369.5, 375.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`En$$ = 1, $CellContext`j$$ = 
        1, $CellContext`k$$ = 782, $CellContext`r$$ = 66182.65628676258}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (
       If[$CellContext`j$$ > $CellContext`k$$, $CellContext`k$$ = \
$CellContext`j$$]; 
       If[$CellContext`k$$ > 
         Part[$CellContext`lenB, $CellContext`En$$], $CellContext`k$$ = 
         Part[$CellContext`lenB, $CellContext`En$$]]; 
       If[$CellContext`r$$ > 
         Part[$CellContext`rMaxs, $CellContext`En$$], $CellContext`r$$ = 
         Part[$CellContext`rMaxs, $CellContext`En$$]]; Grid[{{
           Show[
            ListPointPlot3D[{
              Table[Part[$CellContext`a, $CellContext`En$$, 1, 
                 Span[3, 5]] + $CellContext`p 
                Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                  Span[1, 3]], {$CellContext`i, 2, 
                Length[
                 Part[$CellContext`a, $CellContext`En$$, 
                  Span[2, All]]], 1}], 
              Part[$CellContext`a, $CellContext`En$$, 
               Span[2, All], 
               Span[5, 7]]}, PlotStyle -> {
               Directive[Gray, 
                PointSize[0.001]], 
               Directive[Black, 
                PointSize[0.004]]}, PlotRange -> 
             Table[{-$CellContext`r$$, $CellContext`r$$}, 3], BoxRatios -> 1, 
             ImageSize -> 720, ViewPoint -> Dynamic[$CellContext`vp], 
             ViewVertical -> Dynamic[$CellContext`vv]], 
            Graphics3D[{Black, 
              Arrowheads[0.01], 
              
              Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
                0.15 $CellContext`r$$ $CellContext`Dhat}]}], 
            Graphics3D[{Blue, 
              Arrowheads[0.01], 
              
              Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
                0.15 $CellContext`r$$ $CellContext`Nhat}]}], 
            Graphics3D[{Red, 
              Arrowheads[0.01], 
              
              Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
                0.15 $CellContext`r$$ $CellContext`Fhat}]}], 
            Graphics3D[{LightGray, 
              Arrowheads[0.02], 
              Arrow[{$CellContext`origin, 0.9 $CellContext`r$$ {1, 0, 0}}]}], 
            
            Graphics3D[{LightGray, 
              Arrowheads[0.02], 
              Arrow[{$CellContext`origin, 0.9 $CellContext`r$$ {0, 1, 0}}]}], 
            
            Graphics3D[{LightGray, 
              Arrowheads[0.02], 
              Arrow[{$CellContext`origin, 0.9 $CellContext`r$$ {0, 0, 1}}]}], 
            
            Graphics3D[{White, 
              Opacity[1], 
              Sphere[{0, 0, 0}, $CellContext`rMoon]}], 
            Graphics3D[{Green, 
              Line[
               Part[$CellContext`traces, $CellContext`En$$, 
                Span[$CellContext`j$$, $CellContext`k$$]]]}], 
            Table[
             Graphics3D[{Orange, 
               Arrowheads[0.01], 
               Arrow[{
                 Part[$CellContext`r1s, $CellContext`En$$, $CellContext`i], 
                 Part[$CellContext`r1s, $CellContext`En$$, $CellContext`i] + 
                 0.05 $CellContext`r$$ 
                  Part[$CellContext`v1s, $CellContext`En$$, \
$CellContext`i]}]}], {$CellContext`i, $CellContext`j$$ + 1, $CellContext`k$$ + 
              1, 1}]], 
           Grid[{{
              Show[
               ListPointPlot3D[
                Part[$CellContext`a, $CellContext`En$$, 
                 Span[2, All], 
                 Span[1, 3]], PlotStyle -> Directive[Gray, 
                  PointSize[0.007]], PlotRange -> {-1, 1}, BoxRatios -> 1, 
                ImageSize -> 360, ViewPoint -> Dynamic[$CellContext`vp], 
                ViewVertical -> Dynamic[$CellContext`vv]], 
               Graphics3D[{Black, 
                 Arrowheads[0.02], 
                 Arrow[{$CellContext`origin, $CellContext`Dhat}]}], 
               Graphics3D[{Blue, 
                 Arrowheads[0.02], 
                 Arrow[{$CellContext`origin, $CellContext`Nhat}]}], 
               Graphics3D[{Red, 
                 Arrowheads[0.02], 
                 Arrow[{$CellContext`origin, $CellContext`Fhat}]}], 
               Table[
                Graphics3D[{
                  Darker[Green], 
                  PointSize[0.01], 
                  Point[
                   
                   Part[$CellContext`arrDs, $CellContext`En$$, \
$CellContext`i]]}], {$CellContext`i, $CellContext`j$$ + 1, $CellContext`k$$ + 
                 1, 1}], 
               Table[
                Graphics3D[{
                  Darker[Green], 
                  Arrow[{
                    
                    Part[$CellContext`arrDs, $CellContext`En$$, \
$CellContext`i], $CellContext`origin}]}], {$CellContext`i, $CellContext`j$$ + 
                 1, $CellContext`k$$ + 1, 1}], 
               Table[
                Graphics3D[{Green, 
                  
                  Arrow[{-
                    Part[$CellContext`v2s, $CellContext`En$$, \
$CellContext`i], $CellContext`origin}]}], {$CellContext`i, $CellContext`j$$, \
$CellContext`k$$, 1}]]}, {
              Show[
               ListPointPlot3D[
                Part[$CellContext`a, $CellContext`En$$, 
                 Span[2, All], 
                 Span[5, 7]], PlotStyle -> {
                  Directive[Black, 
                   PointSize[0.007]]}, PlotRange -> 
                Table[1.25 $CellContext`rMoon {-1, 1}, 3], BoxRatios -> 1, 
                ImageSize -> 360, ViewPoint -> Dynamic[$CellContext`vp], 
                ViewVertical -> Dynamic[$CellContext`vv]], 
               Graphics3D[{LightGray, 
                 Arrowheads[0.03], 
                 
                 Arrow[{$CellContext`origin, 
                   1.2 $CellContext`rMoon {1, 0, 0}}]}], 
               Graphics3D[{LightGray, 
                 Arrowheads[0.03], 
                 
                 Arrow[{$CellContext`origin, 
                   1.2 $CellContext`rMoon {0, 1, 0}}]}], 
               Graphics3D[{LightGray, 
                 Arrowheads[0.03], 
                 
                 Arrow[{$CellContext`origin, 
                   1.2 $CellContext`rMoon {0, 0, 1}}]}], 
               Graphics3D[{White, 
                 Opacity[1], 
                 Sphere[$CellContext`origin, $CellContext`rMoon]}], 
               Table[
                Graphics3D[{Orange, 
                  Arrowheads[0.02], 
                  Arrow[{
                    Part[$CellContext`r1s, $CellContext`En$$, $CellContext`i],
                     Part[$CellContext`r1s, $CellContext`En$$, \
$CellContext`i] + 0.1 $CellContext`rMoon 
                    Part[$CellContext`v1s, $CellContext`En$$, \
$CellContext`i]}]}], {$CellContext`i, $CellContext`j$$ + 1, $CellContext`k$$ + 
                 1, 1}]]}}, Frame -> {{False, False}, {False, True}}]}}, 
         Frame -> All]), 
      "Specifications" :> {{{$CellContext`En$$, 1}, 1, 15, 1, 
         Appearance -> {"Open"}}, {{$CellContext`j$$, 1}, 1, 
         Dynamic[
          Part[$CellContext`lenB, $CellContext`En$$]], 1, 
         Appearance -> {"Open"}}, {{$CellContext`k$$, 782}, 
         Dynamic[$CellContext`j$$], 782, 1, 
         Appearance -> {"Open"}}, {{$CellContext`r$$, 66182.65628676258}, 
         2841.9359598696087`, 66182.65628676258, 633.4072032689297, 
         Appearance -> {"Open"}}}, 
      "Options" :> {ContinuousAction -> False, ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1389., {402., 408.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.797078304272512*^9, 3.7970786565205755`*^9, {3.7970787490127115`*^9, 
   3.797078778850105*^9}, 3.7970789524023957`*^9, {3.7970790539241276`*^9, 
   3.797079108285533*^9}, 3.797079260747365*^9, 3.7970793241984673`*^9, 
   3.7970794889135065`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"f85dbfa1-29a1-4bc2-a5cc-fec42aa7fd9d"]
}, Open  ]]
},
WindowSize->{2544, 999},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5bacc4d9-5684-4201-8fb6-89c8d364033d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 248, 4, 28, "Input",ExpressionUUID->"b60bcda4-b1a2-4102-8600-9d2e8b60307c"],
Cell[831, 28, 368, 5, 32, "Output",ExpressionUUID->"5a6f7076-e7c6-4853-b287-3a9f7261b45a"]
}, Open  ]],
Cell[1214, 36, 6582, 166, 869, "Input",ExpressionUUID->"9dbb198b-91d6-48fd-ba27-3ecc46c43c0a"],
Cell[7799, 204, 4468, 130, 276, "Input",ExpressionUUID->"9278cff5-a626-40ea-b990-31a59825014f"],
Cell[CellGroupData[{
Cell[12292, 338, 20107, 463, 941, "Input",ExpressionUUID->"15bf1efb-2181-49b5-b420-56479a96a331"],
Cell[32402, 803, 9467, 208, 850, "Output",ExpressionUUID->"f85dbfa1-29a1-4bc2-a5cc-fec42aa7fd9d"]
}, Open  ]]
}
]
*)

