(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    269340,       6436]
NotebookOptionsPosition[    266473,       6380]
NotebookOutlinePosition[    266874,       6396]
CellTagsIndexPosition[    266831,       6393]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.796733338996614*^9, 3.796733347956118*^9}, {
  3.798191986837683*^9, 3.798191988287858*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"b60bcda4-b1a2-4102-8600-9d2e8b60307c"],

Cell[BoxData["\<\"C:\\\\msys64\\\\home\\\\wtdai\\\\HASTE\\\\testing\\\\\
prevTrajectory\\\\plotting\"\>"], "Output",
 CellChangeTimes->{3.796733348625154*^9, 3.7969797290065126`*^9, 
  3.797065661754725*^9, 3.7970750340799427`*^9, 3.797075084353047*^9, 
  3.7970783017569265`*^9, 3.797079246108926*^9, 3.7970894149564557`*^9, 
  3.797150961316888*^9, 3.797154658849142*^9, 3.7971844386244183`*^9, 
  3.797185765073704*^9, 3.798191989864003*^9, 3.7983612856808453`*^9, 
  3.798362089972694*^9, 3.79836716136767*^9, 3.7983730500121*^9, 
  3.7983758866384735`*^9},
 CellLabel->
  "Out[273]=",ExpressionUUID->"11d41d6a-833a-4f83-b4fe-9db273bcf638"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Edetect", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "8"}]]}], ",", 
     RowBox[{"2.5", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "8"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"2", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"3", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"4", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"5", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"6", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"8", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ",", 
     RowBox[{"3.16", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", 
     RowBox[{"1", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointfiles", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<prevLPemissionPoints_e01.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e02.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e03.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e04.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e05.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e06.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e07.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e08.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e09.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e10.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e11.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e12.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e13.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e14.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e15.tst\>\""}], "\[IndentingNewLine]", "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tracefiles", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<prevLPemissionPoints_e01_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e02_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e03_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e04_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e05_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e06_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e07_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e08_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e09_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e10_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e11_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e12_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e13_traces.tst\>\"", ",", 
     "\[IndentingNewLine]", "\"\<prevLPemissionPoints_e14_traces.tst\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<prevLPemissionPoints_e15_traces.tst\>\""}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mapfiles", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<LPemissionMap_e01.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e02.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e03.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e04.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e05.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e06.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e07.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e08.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e09.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e10.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e11.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e12.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e13.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e14.tst\>\"", ",", "\[IndentingNewLine]", 
     "\"\<LPemissionMap_e15.tst\>\""}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rMoon", "=", "1737"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aMoon", "=", 
   RowBox[{"0.3844", " ", 
    SuperscriptBox["10", "6"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mMoon", "=", 
   RowBox[{"0.07346", " ", 
    SuperscriptBox["10", "24"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mEarth", "=", 
   RowBox[{"5.9724", " ", 
    SuperscriptBox["10", "24"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rSOImoon", "=", 
   RowBox[{"aMoon", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["mMoon", "mEarth"], ")"}], 
     RowBox[{"2", "/", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "250"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vp", ",", "vv"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Options", "[", 
     RowBox[{"Graphics3D", ",", 
      RowBox[{"{", 
       RowBox[{"ViewPoint", ",", "ViewVertical"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ReadList", "[", 
      RowBox[{
       RowBox[{"pointfiles", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "Number", ",", 
       RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pointfiles", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"ReadList", "[", 
        RowBox[{
         RowBox[{"tracefiles", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "Number", ",", 
         RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}], ",", "11"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "tracefiles", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ReadList", "[", 
      RowBox[{
       RowBox[{"mapfiles", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "Number", ",", 
       RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "mapfiles", "]"}], ",", "1"}], "}"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.797066338090611*^9, 3.7970664314961925`*^9}, {
  3.797066487031848*^9, 3.7970666114325123`*^9}, {3.7970668590805407`*^9, 
  3.7970669756878734`*^9}, {3.7970739363531675`*^9, 3.7970739541600037`*^9}, {
  3.797074015971945*^9, 3.797074081113426*^9}, {3.797076621741613*^9, 
  3.7970766334342833`*^9}, {3.79707925341984*^9, 3.7970792540248213`*^9}, {
  3.7981920246085997`*^9, 3.7981921142112494`*^9}, {3.798196316663577*^9, 
  3.798196347958542*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"9dbb198b-91d6-48fd-ba27-3ecc46c43c0a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"origin", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dhat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"9", ";;", "11"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nhat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"12", ";;", "14"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fhat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"15", ";;", "17"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rsat", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"3", ";;", "5"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rView", "=", 
   RowBox[{"Norm", "[", "Rsat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1s", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"5", ";;", "7"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1s", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"8", ";;", "10"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrDs", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2s", "=", 
   RowBox[{"b", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "11", ",", 
      RowBox[{"5", ";;", "7"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"traces", "=", 
   RowBox[{"b", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", ";;", ",", 
      RowBox[{"2", ";;", "4"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lenA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"a", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lenB", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"b", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "b", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trips", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"traces", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rMaxs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"traces", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", "1"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"lenB", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "tracefiles", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7970748535218735`*^9, 3.7970749692772837`*^9}, {
   3.7970751594538703`*^9, 3.7970752181565356`*^9}, {3.7970753138712664`*^9, 
   3.797075354588852*^9}, 3.7970754513753376`*^9, {3.7970755753732796`*^9, 
   3.79707562177192*^9}, {3.797075656523794*^9, 3.7970757056440735`*^9}, {
   3.7970757693886313`*^9, 3.7970757721869235`*^9}, {3.7970758899340196`*^9, 
   3.7970759073712287`*^9}, {3.797075945530746*^9, 3.79707599785165*^9}, {
   3.7970760683465786`*^9, 3.7970761089552736`*^9}, {3.7970762133900356`*^9, 
   3.7970762322832713`*^9}, {3.797076359950075*^9, 3.7970763607303324`*^9}, {
   3.7970764461566415`*^9, 3.797076448378286*^9}, {3.7970764867790146`*^9, 
   3.7970765930340805`*^9}, {3.797076643390664*^9, 3.797076661770734*^9}, {
   3.7970776306837053`*^9, 3.7970776309542093`*^9}, {3.7970779584086714`*^9, 
   3.7970779698806486`*^9}, {3.7970791654496346`*^9, 3.7970791846631827`*^9}, 
   3.7970792327141314`*^9, {3.7982159663710585`*^9, 3.7982159679530697`*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"9278cff5-a626-40ea-b990-31a59825014f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"j", ">", "k"}], ",", 
      RowBox[{"k", "=", "j"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"k", ">", 
       RowBox[{"lenB", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}], ",", 
      RowBox[{"k", "=", 
       RowBox[{"lenB", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"r", ">", 
       RowBox[{"rMaxs", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}], ",", 
      RowBox[{"r", "=", 
       RowBox[{"rMaxs", "[", 
        RowBox[{"[", "En", "]"}], "]"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "1", ",", 
                    RowBox[{"3", ";;", "5"}]}], "]"}], "]"}], "+", 
                  RowBox[{"p", " ", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", 
                    RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
                  "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}], ",", 
                  RowBox[{"5", ";;", "7"}]}], "]"}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Directive", "[", 
                 RowBox[{"Gray", ",", 
                  RowBox[{"PointSize", "[", "0.001", "]"}]}], "]"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", 
                  RowBox[{"PointSize", "[", "0.004", "]"}]}], "]"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", "3"}], "]"}]}], 
             ",", 
             RowBox[{"BoxRatios", "\[Rule]", "1"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "720"}], ",", 
             RowBox[{"ViewPoint", "\[Rule]", 
              RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", 
             RowBox[{"ViewVertical", "\[Rule]", 
              RowBox[{"Dynamic", "[", "vv", "]"}]}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<En at detector = \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"Edetect", "[", 
                  RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], 
                "]"}], "<>", "\"\< MeV\>\""}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"Rsat", ",", 
                 RowBox[{"Rsat", "+", 
                  RowBox[{".15", "r", " ", "Dhat"}]}]}], "}"}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"Rsat", ",", 
                 RowBox[{"Rsat", "+", 
                  RowBox[{".15", "r", " ", "Nhat"}]}]}], "}"}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"Rsat", ",", 
                 RowBox[{"Rsat", "+", 
                  RowBox[{".15", "r", " ", "Fhat"}]}]}], "}"}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", 
              RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"origin", ",", 
                 RowBox[{"0.9", "r", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", 
              RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"origin", ",", 
                 RowBox[{"0.9", "r", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", 
              RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"origin", ",", 
                 RowBox[{"0.9", "r", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"White", ",", 
              RowBox[{"Opacity", "[", "1", "]"}], ",", 
              RowBox[{"Sphere", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "rMoon"}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Green", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"traces", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"j", ";;", "k"}]}], "]"}], "]"}], "]"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{"Orange", ",", 
                RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "+", 
                    RowBox[{".05", "r", " ", 
                    RowBox[{"v1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}]}]}]}], "}"}], 
                 "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"j", "+", "1"}], ",", 
               RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", 
                    RowBox[{"2", ";;"}], ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"PlotStyle", "->", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Gray", ",", 
                    RowBox[{"PointSize", "[", "0.007", "]"}]}], "]"}]}], ",", 
                  
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
                  RowBox[{"BoxRatios", "\[Rule]", "1"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "360"}], ",", 
                  RowBox[{"ViewPoint", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", 
                  RowBox[{"ViewVertical", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vv", "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"Black", ",", 
                   RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", "Dhat"}], "}"}], "]"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"Blue", ",", 
                   RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", "Nhat"}], "}"}], "]"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"Red", ",", 
                   RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", "Fhat"}], "}"}], "]"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Green", "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"arrDs", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Green", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"arrDs", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", "origin"}], 
                    "}"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"v2s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}]}], ",", "origin"}],
                     "}"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}]}], 
                 "]"}]}], "\[IndentingNewLine]", "]"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", 
                    RowBox[{"2", ";;"}], ",", 
                    RowBox[{"5", ";;", "7"}]}], "]"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.007", "]"}]}], "]"}], 
                    "}"}]}], ",", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"1.25", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "3"}], 
                    "]"}]}], ",", 
                  RowBox[{"BoxRatios", "\[Rule]", "1"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "360"}], ",", 
                  RowBox[{"ViewPoint", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", 
                  RowBox[{"ViewVertical", "\[Rule]", 
                   RowBox[{"Dynamic", "[", "vv", "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"LightGray", ",", 
                   RowBox[{"Arrowheads", "[", ".03", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", 
                    RowBox[{"1.2", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"LightGray", ",", 
                   RowBox[{"Arrowheads", "[", ".03", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", 
                    RowBox[{"1.2", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"LightGray", ",", 
                   RowBox[{"Arrowheads", "[", ".03", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{"origin", ",", 
                    RowBox[{"1.2", "rMoon", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{"{", 
                  RowBox[{"White", ",", 
                   RowBox[{"Opacity", "[", "1", "]"}], ",", 
                   RowBox[{"Sphere", "[", 
                    RowBox[{"origin", ",", "rMoon"}], "]"}]}], "}"}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Graphics3D", "[", 
                   RowBox[{"{", 
                    RowBox[{"Orange", ",", 
                    RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"r1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "+", 
                    RowBox[{".1", "rMoon", " ", 
                    RowBox[{"v1s", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}]}]}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "}"}]}], "\[IndentingNewLine]", 
            "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"False", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"False", ",", "True"}], "}"}]}], "}"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "}"}], ",", 
      RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"En", ",", "1"}], "}"}], ",", "1", ",", 
     RowBox[{"Length", "[", "lenA", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}], ",", "1", ",", 
     RowBox[{"lenB", "[", 
      RowBox[{"[", "En", "]"}], "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Max", "[", "lenB", "]"}]}], "}"}], ",", "j", ",", 
     RowBox[{"Max", "[", "lenB", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "rSOImoon"}], "}"}], ",", "rView", ",", "rSOImoon", 
     ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"rSOImoon", "-", 
        RowBox[{"Norm", "[", "Rsat", "]"}]}], ")"}], "/", "100"}], ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.79707210405431*^9, 3.797072111110836*^9}, {
   3.797072358442602*^9, 3.7970723616393156`*^9}, {3.797072506408371*^9, 
   3.7970725809515533`*^9}, {3.797072626664154*^9, 3.797072652265771*^9}, {
   3.7970727356427994`*^9, 3.797072758519376*^9}, {3.7970729504424524`*^9, 
   3.797072960695695*^9}, {3.7970730701040173`*^9, 3.797073097190971*^9}, {
   3.7970733001377597`*^9, 3.797073357637779*^9}, {3.797073458280615*^9, 
   3.797073467286807*^9}, {3.7970735698934937`*^9, 3.7970736129337873`*^9}, {
   3.7970740908725348`*^9, 3.7970742144861927`*^9}, {3.797074366840567*^9, 
   3.797074463189539*^9}, {3.797074581366258*^9, 3.7970746683892083`*^9}, {
   3.797075235621581*^9, 3.797075239364196*^9}, {3.7970752972045493`*^9, 
   3.797075385650344*^9}, {3.797075539132174*^9, 3.7970755421316347`*^9}, {
   3.797075837394846*^9, 3.7970758777310963`*^9}, {3.7970759147705193`*^9, 
   3.7970759324850655`*^9}, {3.797076017364519*^9, 3.797076030610388*^9}, {
   3.7970762542414083`*^9, 3.79707626200105*^9}, {3.7970767004829874`*^9, 
   3.79707676843302*^9}, {3.7970768813784046`*^9, 3.797076896193103*^9}, {
   3.797077076097308*^9, 3.7970771733754683`*^9}, {3.797077224994714*^9, 
   3.7970772579189568`*^9}, {3.797077983934599*^9, 3.7970779897426124`*^9}, {
   3.7970780213939257`*^9, 3.797078023485695*^9}, {3.7970781006577415`*^9, 
   3.7970781248780413`*^9}, {3.7970781631059136`*^9, 
   3.7970782302859497`*^9}, {3.797078642816222*^9, 3.7970786558526278`*^9}, {
   3.797078721056148*^9, 3.797078772432728*^9}, {3.797078916050456*^9, 
   3.797078945102229*^9}, {3.7970790248821335`*^9, 3.797079107454005*^9}, {
   3.7970791992327566`*^9, 3.7970792231986666`*^9}, {3.797079322289316*^9, 
   3.7970793224475107`*^9}, {3.7970794862719502`*^9, 3.797079487900835*^9}, {
   3.797153319642765*^9, 3.7971533450487137`*^9}, {3.797153462444298*^9, 
   3.7971535228879175`*^9}, {3.797153557400695*^9, 3.7971535759444284`*^9}, {
   3.797154705684823*^9, 3.7971547225615034`*^9}, 3.7982159841061635`*^9},
 CellLabel->
  "In[303]:=",ExpressionUUID->"15bf1efb-2181-49b5-b420-56479a96a331"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 1, $CellContext`j$$ = 
    1, $CellContext`k$$ = 782, $CellContext`r$$ = 63446.14838450865, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`En$$], 1}, 1, 15, 1}, {{
       Hold[$CellContext`j$$], 1}, 1, 
      Dynamic[
       Part[$CellContext`lenB, $CellContext`En$$]], 1}, {{
       Hold[$CellContext`k$$], 782}, 
      Dynamic[$CellContext`j$$], 782, 1}, {{
       Hold[$CellContext`r$$], 66182.65628676258}, 2841.9359598696087`, 
      66182.65628676258, 633.4072032689297}}, Typeset`size$$ = {
    1103., {371., 377.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`En$$ = 1, $CellContext`j$$ = 
        1, $CellContext`k$$ = 782, $CellContext`r$$ = 66182.65628676258}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (
       If[$CellContext`j$$ > $CellContext`k$$, $CellContext`k$$ = \
$CellContext`j$$]; 
       If[$CellContext`k$$ > 
         Part[$CellContext`lenB, $CellContext`En$$], $CellContext`k$$ = 
         Part[$CellContext`lenB, $CellContext`En$$]]; 
       If[$CellContext`r$$ > 
         Part[$CellContext`rMaxs, $CellContext`En$$], $CellContext`r$$ = 
         Part[$CellContext`rMaxs, $CellContext`En$$]]; Grid[{{
           Show[
            ListPointPlot3D[{
              Table[Part[$CellContext`a, $CellContext`En$$, 1, 
                 Span[3, 5]] + $CellContext`p 
                Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                  Span[1, 3]], {$CellContext`i, 2, 
                Length[
                 Part[$CellContext`a, $CellContext`En$$, 
                  Span[2, All]]], 1}], 
              Part[$CellContext`a, $CellContext`En$$, 
               Span[2, All], 
               Span[5, 7]]}, PlotStyle -> {
               Directive[Gray, 
                PointSize[0.001]], 
               Directive[Black, 
                PointSize[0.004]]}, PlotRange -> 
             Table[{-$CellContext`r$$, $CellContext`r$$}, 3], BoxRatios -> 1, 
             ImageSize -> 720, ViewPoint -> Dynamic[$CellContext`vp], 
             ViewVertical -> Dynamic[$CellContext`vv], PlotLabel -> 
             StringJoin["En at detector = ", 
               ToString[
                Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
               " MeV"]], 
            Graphics3D[{Black, 
              Arrowheads[0.01], 
              
              Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
                0.15 $CellContext`r$$ $CellContext`Dhat}]}], 
            Graphics3D[{Blue, 
              Arrowheads[0.01], 
              
              Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
                0.15 $CellContext`r$$ $CellContext`Nhat}]}], 
            Graphics3D[{Red, 
              Arrowheads[0.01], 
              
              Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
                0.15 $CellContext`r$$ $CellContext`Fhat}]}], 
            Graphics3D[{LightGray, 
              Arrowheads[0.02], 
              Arrow[{$CellContext`origin, 0.9 $CellContext`r$$ {1, 0, 0}}]}], 
            
            Graphics3D[{LightGray, 
              Arrowheads[0.02], 
              Arrow[{$CellContext`origin, 0.9 $CellContext`r$$ {0, 1, 0}}]}], 
            
            Graphics3D[{LightGray, 
              Arrowheads[0.02], 
              Arrow[{$CellContext`origin, 0.9 $CellContext`r$$ {0, 0, 1}}]}], 
            
            Graphics3D[{White, 
              Opacity[1], 
              Sphere[{0, 0, 0}, $CellContext`rMoon]}], 
            Graphics3D[{Green, 
              Line[
               Part[$CellContext`traces, $CellContext`En$$, 
                Span[$CellContext`j$$, $CellContext`k$$]]]}], 
            Table[
             Graphics3D[{Orange, 
               Arrowheads[0.01], 
               Arrow[{
                 Part[$CellContext`r1s, $CellContext`En$$, $CellContext`i], 
                 Part[$CellContext`r1s, $CellContext`En$$, $CellContext`i] + 
                 0.05 $CellContext`r$$ 
                  Part[$CellContext`v1s, $CellContext`En$$, \
$CellContext`i]}]}], {$CellContext`i, $CellContext`j$$ + 1, $CellContext`k$$ + 
              1, 1}]], 
           Grid[{{
              Show[
               ListPointPlot3D[
                Part[$CellContext`a, $CellContext`En$$, 
                 Span[2, All], 
                 Span[1, 3]], PlotStyle -> Directive[Gray, 
                  PointSize[0.007]], PlotRange -> {-1, 1}, BoxRatios -> 1, 
                ImageSize -> 360, ViewPoint -> Dynamic[$CellContext`vp], 
                ViewVertical -> Dynamic[$CellContext`vv]], 
               Graphics3D[{Black, 
                 Arrowheads[0.02], 
                 Arrow[{$CellContext`origin, $CellContext`Dhat}]}], 
               Graphics3D[{Blue, 
                 Arrowheads[0.02], 
                 Arrow[{$CellContext`origin, $CellContext`Nhat}]}], 
               Graphics3D[{Red, 
                 Arrowheads[0.02], 
                 Arrow[{$CellContext`origin, $CellContext`Fhat}]}], 
               Table[
                Graphics3D[{
                  Darker[Green], 
                  PointSize[0.01], 
                  Point[
                   
                   Part[$CellContext`arrDs, $CellContext`En$$, \
$CellContext`i]]}], {$CellContext`i, $CellContext`j$$ + 1, $CellContext`k$$ + 
                 1, 1}], 
               Table[
                Graphics3D[{
                  Darker[Green], 
                  Arrow[{
                    
                    Part[$CellContext`arrDs, $CellContext`En$$, \
$CellContext`i], $CellContext`origin}]}], {$CellContext`i, $CellContext`j$$ + 
                 1, $CellContext`k$$ + 1, 1}], 
               Table[
                Graphics3D[{Green, 
                  
                  Arrow[{-
                    Part[$CellContext`v2s, $CellContext`En$$, \
$CellContext`i], $CellContext`origin}]}], {$CellContext`i, $CellContext`j$$, \
$CellContext`k$$, 1}]]}, {
              Show[
               ListPointPlot3D[
                Part[$CellContext`a, $CellContext`En$$, 
                 Span[2, All], 
                 Span[5, 7]], PlotStyle -> {
                  Directive[Black, 
                   PointSize[0.007]]}, PlotRange -> 
                Table[1.25 $CellContext`rMoon {-1, 1}, 3], BoxRatios -> 1, 
                ImageSize -> 360, ViewPoint -> Dynamic[$CellContext`vp], 
                ViewVertical -> Dynamic[$CellContext`vv]], 
               Graphics3D[{LightGray, 
                 Arrowheads[0.03], 
                 
                 Arrow[{$CellContext`origin, 
                   1.2 $CellContext`rMoon {1, 0, 0}}]}], 
               Graphics3D[{LightGray, 
                 Arrowheads[0.03], 
                 
                 Arrow[{$CellContext`origin, 
                   1.2 $CellContext`rMoon {0, 1, 0}}]}], 
               Graphics3D[{LightGray, 
                 Arrowheads[0.03], 
                 
                 Arrow[{$CellContext`origin, 
                   1.2 $CellContext`rMoon {0, 0, 1}}]}], 
               Graphics3D[{White, 
                 Opacity[1], 
                 Sphere[$CellContext`origin, $CellContext`rMoon]}], 
               Table[
                Graphics3D[{Orange, 
                  Arrowheads[0.02], 
                  Arrow[{
                    Part[$CellContext`r1s, $CellContext`En$$, $CellContext`i],
                     Part[$CellContext`r1s, $CellContext`En$$, \
$CellContext`i] + 0.1 $CellContext`rMoon 
                    Part[$CellContext`v1s, $CellContext`En$$, \
$CellContext`i]}]}], {$CellContext`i, $CellContext`j$$ + 1, $CellContext`k$$ + 
                 1, 1}]]}}, Frame -> {{False, False}, {False, True}}]}}, 
         Frame -> All]), 
      "Specifications" :> {{{$CellContext`En$$, 1}, 1, 15, 1, 
         Appearance -> {"Open"}}, {{$CellContext`j$$, 1}, 1, 
         Dynamic[
          Part[$CellContext`lenB, $CellContext`En$$]], 1, 
         Appearance -> {"Open"}}, {{$CellContext`k$$, 782}, 
         Dynamic[$CellContext`j$$], 782, 1, 
         Appearance -> {"Open"}}, {{$CellContext`r$$, 66182.65628676258}, 
         2841.9359598696087`, 66182.65628676258, 633.4072032689297, 
         Appearance -> {"Open"}}}, 
      "Options" :> {ContinuousAction -> False, ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1389., {403., 409.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.7983612943931203`*^9, 3.798362093379381*^9, 
  3.7983671669164042`*^9, 3.79837588955054*^9},
 CellLabel->
  "Out[303]=",ExpressionUUID->"ff83ceb7-7b74-4cfa-bd3f-f26feeb0ae77"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"padding", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"72", ",", "48"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"36", ",", "20"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tofEnpairs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Riffle", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", 
            RowBox[{"2", ";;"}], ",", "4"}], "]"}], "]"}], ",", 
         FractionBox[
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", 
             RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}], "1000"]}], "]"}],
        ",", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "a", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tofDpairs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Riffle", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", 
            RowBox[{"2", ";;"}], ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", 
            RowBox[{"2", ";;"}], ",", "12"}], "]"}], "]"}]}], "]"}], ",", 
       "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "a", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Overlay", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListLogLogPlot", "[", 
        RowBox[{
         RowBox[{"tofEnpairs", "[", 
          RowBox[{"[", "En", "]"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Blue", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Black"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<En [keV]\>\"", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<tof [s]\>\"", ",", 
              RowBox[{"\"\<En at detector = \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"Edetect", "[", 
                  RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], 
                "]"}], "<>", "\"\< MeV\>\""}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", "padding"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLogLogPlot", "[", 
        RowBox[{
         RowBox[{"tofDpairs", "[", 
          RowBox[{"[", "En", "]"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"False", ",", "True"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", "Red"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", "\"\<D-factor\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", "padding"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"En", ",", "1", ",", 
     RowBox[{"Length", "[", "a", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.797089445002349*^9, 3.7970894801687775`*^9}, {
   3.7970896113717327`*^9, 3.7970896274193573`*^9}, {3.7970900255486903`*^9, 
   3.797090145224023*^9}, {3.7970922837369566`*^9, 3.7970923058457174`*^9}, {
   3.797092398776623*^9, 3.797092485637523*^9}, {3.797092533688526*^9, 
   3.79709253840524*^9}, {3.797092604152244*^9, 3.7970926093811665`*^9}, {
   3.7970926582802835`*^9, 3.7970927721305265`*^9}, {3.797092817463296*^9, 
   3.7970928417485476`*^9}, {3.797092895655408*^9, 3.7970929074608746`*^9}, {
   3.797093095431523*^9, 3.797093237860895*^9}, 3.797093401735253*^9, {
   3.797093432116596*^9, 3.7970936641798058`*^9}, {3.797093796791472*^9, 
   3.79709391448736*^9}, {3.797093948151861*^9, 3.797094041971673*^9}, {
   3.797151003451092*^9, 3.7971513209178553`*^9}, {3.797151396104431*^9, 
   3.7971514650303354`*^9}, 3.7971515343932514`*^9, {3.797151702757407*^9, 
   3.7971517571732473`*^9}, {3.7971531706787195`*^9, 3.797153170948251*^9}, {
   3.7971547594530306`*^9, 3.7971549033765717`*^9}, {3.797155384958357*^9, 
   3.7971553941872144`*^9}, {3.7971588457705207`*^9, 
   3.7971589573366537`*^9}, {3.7971589907965765`*^9, 3.797159039560944*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"df1190f4-06a7-4325-a642-7fbde80f39ae"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`En$$], 1, 15, 1}}, Typeset`size$$ = {
    576., {166., 172.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`En$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Overlay[{
         ListLogLogPlot[
          Part[$CellContext`tofEnpairs, $CellContext`En$$], ImageSize -> 
          Large, PlotStyle -> Blue, Frame -> {{True, False}, {True, True}}, 
          FrameTicks -> {{True, False}, {True, False}}, 
          FrameStyle -> {{Blue, None}, {Black, Black}}, 
          FrameLabel -> {{"En [keV]", None}, {"tof [s]", 
             StringJoin["En at detector = ", 
              ToString[
               Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
              " MeV"]}}, ImagePadding -> $CellContext`padding], 
         ListLogLogPlot[
          Part[$CellContext`tofDpairs, $CellContext`En$$], ImageSize -> Large,
           PlotStyle -> Red, Frame -> {{False, True}, {False, False}}, 
          FrameTicks -> True, FrameStyle -> {{None, Red}, {None, None}}, 
          FrameLabel -> {{None, "D-factor"}, {None, None}}, 
          ImagePadding -> $CellContext`padding]}, Alignment -> Center], 
      "Specifications" :> {{$CellContext`En$$, 1, 15, 1, 
         Appearance -> {"Open"}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{627., {226., 232.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.798361306143422*^9, 3.798362100028684*^9, 
  3.798367175272229*^9, 3.7983758953082724`*^9},
 CellLabel->
  "Out[307]=",ExpressionUUID->"9d866eec-863a-448a-afc7-4abb91599b28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EnIpairs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Riffle", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", 
             RowBox[{"2", ";;"}], ",", "11"}], "]"}], "]"}], "1000"], ",", 
         FractionBox["2376", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{"En", ",", 
              RowBox[{"2", ";;"}], ",", "12"}], "]"}], "]"}], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{" ", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}], ",", "4"}], "]"}], "]"}]}], 
              "L"]}]]}]]}], "]"}], ",", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "a", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"m1", "\[GreaterEqual]", "m2"}], ",", 
      RowBox[{"m2", "=", 
       RowBox[{"m1", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ListLogLogPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"EnIpairs", "[", 
        RowBox[{"[", "En", "]"}], "]"}], "/.", 
       RowBox[{"L", "\[Rule]", "Ln"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", "m1"], ",", 
           SuperscriptBox["10", "m2"]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<I [n-surface per n-detector]\>\"", ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<En [MeV]\>\"", ",", 
           RowBox[{"\"\<En at detector = \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Edetect", "[", 
               RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], "]"}], 
            "<>", "\"\< MeV\>\""}]}], "}"}]}], "}"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"En", ",", "1", ",", 
     RowBox[{"Length", "[", "a", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ln", ",", "881"}], "}"}], ",", "875", ",", "895", ",", "0.5", 
     ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m1", ",", "9"}], "}"}], ",", "1", ",", "60", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m2", ",", "15"}], "}"}], ",", "1", ",", "60", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Right"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQ7aUxlb/O643jo7mThUD0MqmVYiC6KYtbG0SzCdp5
g2hjr+N+ILosaE4siNb4fDYRRG82C0sH0e/uluaC6IMekXUg+siLJDBdwbVz
Kog2DyxeBqKlXsevA9GVpwzXg2if+7GbwereLt4KoktWeU2tB9IxuovXguip
1habQfTtVWe3g2j7008OgWgFtR+HQbSm54QzIHrmtPuXQPRKD7UHIHrft9tP
QbR3mcQrEB20TRVMu1yoed4ApHfms70A0cvWP3oPou/tm/IBROc0HPsFoiNu
3/gNollVywUbgfT/pwUiILpo5UMJEC30pd0QRP95Zm8Hov/t+e8MorkVzvqA
6HX1Jr4gOqVsy4RmIC1r9g5MP9siMgtEJ5X0gumLPEs/9ILse+b6B0zrHdTs
A9KXl4Rpg2gAeh7VCw==
  "],
 CellLabel->
  "In[308]:=",ExpressionUUID->"62e629e0-eb67-45ec-bb1d-b0a47eb72723"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 1, $CellContext`Ln$$ = 
    881, $CellContext`m1$$ = 9, $CellContext`m2$$ = 15, Typeset`show$$ = True,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`En$$], 1, 15, 1}, {{
       Hold[$CellContext`Ln$$], 881}, 875, 895, 0.5}, {{
       Hold[$CellContext`m1$$], 9}, 1, 60, 1}, {{
       Hold[$CellContext`m2$$], 15}, 1, 60, 1}}, Typeset`size$$ = {
    576., {190., 194.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`En$$ = 1, $CellContext`Ln$$ = 
        881, $CellContext`m1$$ = 9, $CellContext`m2$$ = 15}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (
       If[$CellContext`m1$$ >= $CellContext`m2$$, $CellContext`m2$$ = \
$CellContext`m1$$ + 1]; ListLogLogPlot[
         ReplaceAll[
          
          Part[$CellContext`EnIpairs, $CellContext`En$$], $CellContext`L -> \
$CellContext`Ln$$], ImageSize -> Large, 
         PlotRange -> {All, {10^$CellContext`m1$$, 10^$CellContext`m2$$}}, 
         PlotStyle -> Blue, Frame -> True, 
         FrameTicks -> {{True, False}, {True, False}}, FrameStyle -> Black, 
         FrameLabel -> {{"I [n-surface per n-detector]", None}, {"En [MeV]", 
            StringJoin["En at detector = ", 
             ToString[
              Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
             " MeV"]}}]), 
      "Specifications" :> {{$CellContext`En$$, 1, 15, 1, 
         Appearance -> {"Open"}}, {{$CellContext`Ln$$, 881}, 875, 895, 0.5, 
         Appearance -> {"Open"}}, {{$CellContext`m1$$, 9}, 1, 60, 1, 
         Appearance -> {"Open"}}, {{$CellContext`m2$$, 15}, 1, 60, 1, 
         Appearance -> {"Open"}}}, "Options" :> {ControlPlacement -> Right}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{864., {221., 227.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.798361310554977*^9, 3.7983621011204543`*^9, 
  3.798367176454832*^9, 3.7983758960621643`*^9},
 CellLabel->
  "Out[309]=",ExpressionUUID->"928de7be-e050-41c0-9bf0-d5f6a3c4c78e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"latTicks", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "90"}], ",", "90", ",", "15"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lonTicks", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "180"}], ",", "180", ",", "30"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spread", "=", "2.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LonLatRect5", "[", "xy_", "]"}], ":=", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"xy", "-", "spread"}], ",", 
     RowBox[{"xy", "+", "spread"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[310]:=",ExpressionUUID->"8e644a2f-8674-48d6-ab91-8e73c256e1b4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "16"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "/", 
      RowBox[{"Max", "[", 
       RowBox[{"CmapTriplets", "[", 
        RowBox[{"[", 
         RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cmap2lists", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"CmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"CmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "CmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmapColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
        RowBox[{"CmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"CmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "CmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmapVecs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"1.01", "rMoon", " ", 
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", 
         RowBox[{"2", ";;"}], ",", 
         RowBox[{"3", ";;", "5"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "rView"}], ",", "rView"}], "}"}], ",", "3"}], 
             "]"}]}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{
            "\"\<RELATIVE NUMBER OF DETECTION EVENTS ORIGINATING\\n\\nEn at \
detector = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"Edetect", "[", 
                RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], "]"}], 
             "<>", "\"\< MeV\>\""}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", 
                RowBox[{"PointSize", "[", "0.003", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i", ",", 
                  RowBox[{"5", ";;", "7"}]}], "]"}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Gray", ",", 
                RowBox[{"PointSize", "[", "0.001", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"En", ",", "1", ",", 
                   RowBox[{"3", ";;", "5"}]}], "]"}], "]"}], "+", 
                RowBox[{"p", " ", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"En", ",", "i", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"CmapColors", "[", 
               RowBox[{"[", 
                RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"CmapVecs", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"CmapVecs", "[", 
                RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
           "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Dhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Nhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Fhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Specularity", "[", 
             RowBox[{"White", ",", "100"}], "]"}], ",", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            "LightGray", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"Sphere", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "rMoon"}], 
             "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "360"}], ",", 
                RowBox[{"-", "360"}]}], "}"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"AspectRatio", "\[Rule]", 
               RowBox[{"1", "/", "2"}]}], ",", 
              RowBox[{"GridLines", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                  "]"}]}], "}"}]}], ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
              RowBox[{"FrameTicks", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Lon [deg]\>\"", ",", "\"\<Relative Intensity\>\""}], 
                  "}"}]}], "}"}]}], ",", 
              RowBox[{"PlotLegends", "\[Rule]", 
               RowBox[{"Placed", "[", 
                RowBox[{
                 RowBox[{"BarLegend", "[", "\"\<Rainbow\>\"", "]"}], ",", 
                 "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"EdgeForm", "[", 
                  RowBox[{"{", 
                   RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                 RowBox[{"CmapColors", "[", 
                  RowBox[{"[", 
                   RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                 RowBox[{"LonLatRect5", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Cmap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Cmap2lists", "[", 
                  RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}],
              "]"}]}], "\[IndentingNewLine]", "]"}], "}"}], 
         "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"ListDensityPlot", "[", 
           RowBox[{
            RowBox[{"CmapTriplets", "[", 
             RowBox[{"[", "En", "]"}], "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
              "}"}]}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"1", "/", "2"}]}], ",", 
            RowBox[{"GridLines", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                "]"}]}], "}"}]}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Lon [deg]\>\"", ",", "\"\<Relative Intensity\>\""}], 
                "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotLegends", "\[Rule]", 
             RowBox[{"Placed", "[", 
              RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
            RowBox[{"ColorFunction", "\[Rule]", 
             RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}]}]}], "]"}], 
          "}"}], "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]",
       "}"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"En", ",", "1", ",", 
     RowBox[{"Length", "[", "c", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7983706014378605`*^9, 3.7983706793707085`*^9}, {
   3.7983707902683764`*^9, 3.798370852187323*^9}, {3.7983713589098034`*^9, 
   3.7983713974687614`*^9}, {3.798371539420624*^9, 3.79837155763128*^9}, {
   3.7983716798066044`*^9, 3.798371691996348*^9}, {3.7983724422403793`*^9, 
   3.798372442781375*^9}, {3.7983728725153604`*^9, 3.7983728770680275`*^9}, {
   3.7983729175009823`*^9, 3.798373016796307*^9}, {3.7983733178228683`*^9, 
   3.7983733192603407`*^9}, 3.7983750154409556`*^9, {3.798375047008832*^9, 
   3.7983750510224657`*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"2ea91080-3649-4ade-acf4-d4f619ab0bdf"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`En$$], 1, 15, 1}}, Typeset`size$$ = {
    1860., {312., 318.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`En$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Grid[{{
          Show[
           
           ListPointPlot3D[{}, PlotRange -> 
            Table[{-$CellContext`rView, $CellContext`rView}, 3], 
            BoxRatios -> {1, 1, 1}, ImageSize -> Large, PlotLabel -> 
            StringJoin[
             "RELATIVE NUMBER OF DETECTION EVENTS ORIGINATING\n\nEn at \
detector = ", 
              ToString[
               Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
              " MeV"]], 
           Graphics3D[
            Table[{
              Directive[Black, 
               PointSize[0.003]], 
              Point[
               Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                Span[5, 7]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              Directive[Gray, 
               PointSize[0.001]], 
              Point[Part[$CellContext`a, $CellContext`En$$, 1, 
                 Span[3, 5]] + $CellContext`p 
                Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                  Span[1, 3]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              
              Part[$CellContext`CmapColors, $CellContext`En$$, \
$CellContext`i], 
              Point[
               
               Part[$CellContext`CmapVecs, $CellContext`En$$, \
$CellContext`i]]}, {$CellContext`i, 1, 
              Length[
               Part[$CellContext`CmapVecs, $CellContext`En$$]], 1}]], 
           Graphics3D[{Black, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Dhat}]}], 
           Graphics3D[{Blue, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Nhat}]}], 
           Graphics3D[{Red, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Fhat}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {1, 0, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 1, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 0, 1}}]}], 
           Graphics3D[{
             Specularity[White, 100], Lighting -> "Neutral", LightGray, 
             Opacity[1], 
             Sphere[{0, 0, 0}, $CellContext`rMoon]}]], 
          Grid[{{
             Show[
              
              ListPlot[{-360, -360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {
                 "Lon [deg]", "Relative Intensity"}}, PlotLegends -> Placed[
                 BarLegend["Rainbow"], Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`CmapColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Cmap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Cmap2lists, $CellContext`En$$]], 1}]]}}], 
          Grid[{{
             ListDensityPlot[
              Part[$CellContext`CmapTriplets, $CellContext`En$$], ImageSize -> 
              Large, PlotRange -> {{-180, 180}, {-90, 90}, Full}, AspectRatio -> 
              1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {
                "Lon [deg]", "Relative Intensity"}}, PlotLegends -> 
              Placed[Automatic, Left], ColorFunction -> 
              ColorData["Rainbow"]]}}]}}], 
      "Specifications" :> {{$CellContext`En$$, 1, 15, 1, 
         Appearance -> {"Open"}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1911., {372., 378.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7983706836611676`*^9, 3.7983708194969187`*^9, 3.7983708545593653`*^9, {
   3.7983715511025653`*^9, 3.79837155888223*^9}, 3.7983716966339827`*^9, 
   3.798372449384299*^9, 3.7983728091091256`*^9, 3.7983730689561424`*^9, 
   3.798373422659112*^9, {3.7983750239715877`*^9, 3.798375052530239*^9}, 
   3.798375897585084*^9},
 CellLabel->
  "Out[319]=",ExpressionUUID->"d179013f-b23d-4d48-9ab4-03ce2bb1a288"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "6"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FErrmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "7"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FErrmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"100", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"FErrmapTriplets", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], "/", 
      RowBox[{"FmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "/", 
      RowBox[{"Max", "[", 
       RowBox[{"FmapTriplets", "[", 
        RowBox[{"[", 
         RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fmap2lists", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"FmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"FmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "FmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FmapColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
        RowBox[{"FmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"FmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "FmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FmapErrColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], "}"}], 
         "]"}], "[", 
        RowBox[{
         RowBox[{"FErrmapTriplets", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "/", "100"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"FErrmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "FErrmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FmapVecs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"1.01", "rMoon", " ", 
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", 
         RowBox[{"2", ";;"}], ",", 
         RowBox[{"3", ";;", "5"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "rView"}], ",", "rView"}], "}"}], ",", "3"}], 
             "]"}]}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{
            "\"\<RELATIVE WEIGHT (BY DIVERGENCE) OF DETECTION EVENTS \
ORIGINATING\\n\\nEn at detector = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"Edetect", "[", 
                RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], "]"}], 
             "<>", "\"\< MeV\>\""}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", 
                RowBox[{"PointSize", "[", "0.003", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i", ",", 
                  RowBox[{"5", ";;", "7"}]}], "]"}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Gray", ",", 
                RowBox[{"PointSize", "[", "0.001", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"En", ",", "1", ",", 
                   RowBox[{"3", ";;", "5"}]}], "]"}], "]"}], "+", 
                RowBox[{"p", " ", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"En", ",", "i", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FmapColors", "[", 
               RowBox[{"[", 
                RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"FmapVecs", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"FmapVecs", "[", 
                RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
           "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Dhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Nhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Fhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Specularity", "[", 
             RowBox[{"White", ",", "100"}], "]"}], ",", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            "LightGray", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"Sphere", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "rMoon"}], 
             "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "360"}], ",", 
                 RowBox[{"-", "360"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                   "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Lon [deg]\>\"", ",", "\"\<Relative Intensity\>\""}], 
                   "}"}]}], "}"}]}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"BarLegend", "[", "\"\<Rainbow\>\"", "]"}], ",", 
                  "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                  RowBox[{"FmapColors", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"LonLatRect5", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Fmap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Fmap2lists", "[", 
                   RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "360"}], ",", "360"}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                   "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Lon [deg]\>\"", ",", 
                    "\"\<Relative Std Err [x100%]\>\""}], "}"}]}], "}"}]}], 
               ",", 
               RowBox[{"PlotLegends", "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"BarLegend", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], 
                    "}"}], "]"}], "[", "#", "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
                  "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                  RowBox[{"FmapErrColors", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"LonLatRect5", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Fmap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Fmap2lists", "[", 
                   RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{
             RowBox[{"FmapTriplets", "[", 
              RowBox[{"[", "En", "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
               "}"}]}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Lon [deg]\>\"", ",", "\"\<Relative Intensity\>\""}], 
                 "}"}]}], "}"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}]}]}], "]"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{
             RowBox[{"FErrmapTriplets", "[", 
              RowBox[{"[", "En", "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
               "}"}]}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Lon [deg]\>\"", ",", "\"\<Relative Std Err [%]\>\""}], 
                 "}"}]}], "}"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], 
                "}"}], "]"}]}]}], "]"}], "}"}]}], "\[IndentingNewLine]", 
         "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"En", ",", "1", ",", 
     RowBox[{"Length", "[", "c", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.798204765122476*^9, 3.798204846160415*^9}, {
   3.7982048814289703`*^9, 3.798204924640787*^9}, {3.7982050871702747`*^9, 
   3.7982051348966813`*^9}, {3.7982051668518095`*^9, 3.798205176049426*^9}, {
   3.798205215013731*^9, 3.7982052275697107`*^9}, {3.798205297123927*^9, 
   3.7982053061780005`*^9}, {3.798205447540818*^9, 3.798205492002108*^9}, {
   3.79820557650144*^9, 3.798205582210847*^9}, {3.7982061015255327`*^9, 
   3.798206130083237*^9}, {3.7982061642917676`*^9, 3.7982062065157948`*^9}, {
   3.798206249334062*^9, 3.798206253779318*^9}, {3.798206338837714*^9, 
   3.798206345300022*^9}, {3.7982064617510805`*^9, 3.798206475684967*^9}, {
   3.7982065851903114`*^9, 3.7982065973000107`*^9}, {3.798206654563865*^9, 
   3.7982066819096823`*^9}, {3.798206751351611*^9, 3.798206769461706*^9}, {
   3.798206894120651*^9, 3.7982068943579507`*^9}, {3.7982069934650035`*^9, 
   3.7982070944533577`*^9}, {3.798207208520162*^9, 3.798207214004459*^9}, {
   3.7982074144719324`*^9, 3.798207433385736*^9}, {3.798207479640481*^9, 
   3.7982074801482863`*^9}, {3.798207555928994*^9, 3.7982075986305666`*^9}, {
   3.7982077047458167`*^9, 3.798207799514056*^9}, {3.7982079058500156`*^9, 
   3.7982079289073086`*^9}, {3.7982079689868445`*^9, 
   3.7982080086962605`*^9}, {3.7982108472329016`*^9, 
   3.7982108941546216`*^9}, {3.798211269363386*^9, 3.7982112759960995`*^9}, {
   3.7982113113418207`*^9, 3.7982113710988307`*^9}, {3.7982114600634365`*^9, 
   3.7982114602997627`*^9}, {3.798211631409254*^9, 3.7982116349087257`*^9}, 
   3.7982121228952208`*^9, {3.798212159039264*^9, 3.7982122691837645`*^9}, {
   3.79821231671973*^9, 3.798212318861304*^9}, {3.7982172165668645`*^9, 
   3.7982172257801056`*^9}, {3.798217862967864*^9, 3.7982178761009893`*^9}, {
   3.798218192377356*^9, 3.7982181953968406`*^9}, {3.798218237703882*^9, 
   3.7982182416379023`*^9}, {3.7982803010207253`*^9, 
   3.7982803210663314`*^9}, {3.7982807009568186`*^9, 
   3.7982808113219137`*^9}, {3.798280877964999*^9, 3.798280918730034*^9}, {
   3.798280949817957*^9, 3.7982809675999336`*^9}, {3.798280998816757*^9, 
   3.7982810061257315`*^9}, {3.798281070526167*^9, 3.798281071006628*^9}, 
   3.798281223917511*^9, {3.7982812664959917`*^9, 3.7982813810690517`*^9}, {
   3.7982814565606413`*^9, 3.7982814675687943`*^9}, {3.7982816087532873`*^9, 
   3.7982816534694443`*^9}, {3.7982817488015738`*^9, 
   3.7982817828137703`*^9}, {3.798281860336586*^9, 3.7982818903014956`*^9}, {
   3.79828194364985*^9, 3.7982819580134196`*^9}, {3.7982820434741125`*^9, 
   3.798282151694733*^9}, {3.7982821947375774`*^9, 3.7982821992628975`*^9}, {
   3.7982822472656307`*^9, 3.7982822851234903`*^9}, {3.7982823509775286`*^9, 
   3.798282375374648*^9}, {3.7982909326544547`*^9, 3.798290939466368*^9}, {
   3.7982912204604435`*^9, 3.798291297116572*^9}, {3.7982940046937227`*^9, 
   3.7982940081941595`*^9}, {3.798294042368969*^9, 3.798294120080758*^9}, {
   3.7982941525930014`*^9, 3.798294317652177*^9}, {3.798294533604207*^9, 
   3.798294548017096*^9}, {3.7982946330461655`*^9, 3.798294706529515*^9}, {
   3.7982950327710123`*^9, 3.7982951410897923`*^9}, {3.7982951713818455`*^9, 
   3.7982952040977006`*^9}, {3.798295235317961*^9, 3.798295290369917*^9}, {
   3.79829539572928*^9, 3.798295396141384*^9}, {3.7982958487453785`*^9, 
   3.798295855607583*^9}, {3.7982959428207083`*^9, 3.7982959450765285`*^9}, {
   3.7982959791722355`*^9, 3.798295993332196*^9}, {3.7982960270607224`*^9, 
   3.798296201092425*^9}, 3.7983671561963606`*^9, {3.79836721763046*^9, 
   3.798367231099974*^9}, {3.7983673183837414`*^9, 3.7983673243802233`*^9}, {
   3.798367382191321*^9, 3.7983674624757004`*^9}, {3.79836751103988*^9, 
   3.7983675839801283`*^9}, {3.798367628848569*^9, 3.798367690859799*^9}, {
   3.798367775439521*^9, 3.7983678298366003`*^9}, {3.7983681091378393`*^9, 
   3.7983681271648955`*^9}, {3.798368187328006*^9, 3.7983682019820795`*^9}, 
   3.7983682817268953`*^9, 3.798368333263198*^9, {3.7983684086726356`*^9, 
   3.798368410829836*^9}, 3.7983692002894793`*^9, {3.7983692370096083`*^9, 
   3.7983692630370307`*^9}, {3.7983695011367793`*^9, 
   3.7983695016777763`*^9}, {3.798372567683717*^9, 3.7983726102543316`*^9}, {
   3.798372795522916*^9, 3.7983727958070946`*^9}, {3.7983728880966578`*^9, 
   3.798372888671842*^9}, {3.798373331585824*^9, 3.7983733362874136`*^9}, 
   3.7983750017790613`*^9, {3.7983758164027357`*^9, 3.7983758289445367`*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"a899b1e0-f61c-4884-a3ed-fcfed9c9b4d4"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`En$$], 1, 15, 1}}, Typeset`size$$ = {
    1863., {322., 328.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`En$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Grid[{{
          Show[
           
           ListPointPlot3D[{}, PlotRange -> 
            Table[{-$CellContext`rView, $CellContext`rView}, 3], 
            BoxRatios -> {1, 1, 1}, ImageSize -> Large, PlotLabel -> 
            StringJoin[
             "RELATIVE WEIGHT (BY DIVERGENCE) OF DETECTION EVENTS ORIGINATING\
\n\nEn at detector = ", 
              ToString[
               Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
              " MeV"]], 
           Graphics3D[
            Table[{
              Directive[Black, 
               PointSize[0.003]], 
              Point[
               Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                Span[5, 7]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              Directive[Gray, 
               PointSize[0.001]], 
              Point[Part[$CellContext`a, $CellContext`En$$, 1, 
                 Span[3, 5]] + $CellContext`p 
                Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                  Span[1, 3]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              
              Part[$CellContext`FmapColors, $CellContext`En$$, \
$CellContext`i], 
              Point[
               
               Part[$CellContext`FmapVecs, $CellContext`En$$, \
$CellContext`i]]}, {$CellContext`i, 1, 
              Length[
               Part[$CellContext`FmapVecs, $CellContext`En$$]], 1}]], 
           Graphics3D[{Black, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Dhat}]}], 
           Graphics3D[{Blue, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Nhat}]}], 
           Graphics3D[{Red, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Fhat}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {1, 0, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 1, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 0, 1}}]}], 
           Graphics3D[{
             Specularity[White, 100], Lighting -> "Neutral", LightGray, 
             Opacity[1], 
             Sphere[{0, 0, 0}, $CellContext`rMoon]}]], 
          Grid[{{
             Show[
              
              ListPlot[{-360, -360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {
                 "Lon [deg]", "Relative Intensity"}}, PlotLegends -> Placed[
                 BarLegend["Rainbow"], Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`FmapColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Fmap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Fmap2lists, $CellContext`En$$]], 1}]]}, {
             Show[
              
              ListPlot[{-360, 360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {
                 "Lon [deg]", "Relative Std Err [x100%]"}}, PlotLegends -> 
               Placed[
                 
                 BarLegend[{
                  ColorData[{"PigeonTones", "Reversed"}][#]& , {0, 1}}], 
                 Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`FmapErrColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Fmap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Fmap2lists, $CellContext`En$$]], 1}]]}}], 
          Grid[{{
             ListDensityPlot[
              Part[$CellContext`FmapTriplets, $CellContext`En$$], ImageSize -> 
              Large, PlotRange -> {{-180, 180}, {-90, 90}, Full}, AspectRatio -> 
              1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {
                "Lon [deg]", "Relative Intensity"}}, PlotLegends -> 
              Placed[Automatic, Left], ColorFunction -> 
              ColorData["Rainbow"]]}, {
             ListDensityPlot[
              Part[$CellContext`FErrmapTriplets, $CellContext`En$$], 
              ImageSize -> Large, PlotRange -> {{-180, 180}, {-90, 90}, Full},
               AspectRatio -> 1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {
                "Lon [deg]", "Relative Std Err [%]"}}, PlotLegends -> 
              Placed[Automatic, Left], ColorFunction -> 
              ColorData[{"PigeonTones", "Reversed"}]]}}]}}], 
      "Specifications" :> {{$CellContext`En$$, 1, 15, 1, 
         Appearance -> {"Open"}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1914., {382., 388.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7982945501811256`*^9, 3.7982946436939616`*^9, 3.7982947092657967`*^9, 
   3.7982951459339623`*^9, 3.79829520636378*^9, 3.798295238792522*^9, 
   3.798295292453883*^9, 3.798295402586605*^9, 3.7982958654604673`*^9, 
   3.79829605913643*^9, 3.7982962054351306`*^9, 3.7983613145148783`*^9, 
   3.7983621025086203`*^9, 3.7983671779518795`*^9, 3.798367232781089*^9, 
   3.798367325772304*^9, 3.798367398256502*^9, {3.798367447372924*^9, 
   3.798367464305746*^9}, 3.7983675200739098`*^9, 3.798367550493352*^9, 
   3.7983675855621357`*^9, 3.7983676923041153`*^9, 3.798367831334625*^9, 
   3.7983681294607697`*^9, 3.798368334881817*^9, 3.798368412052952*^9, 
   3.7983692019715796`*^9, 3.7983692745964155`*^9, 3.798369503292983*^9, 
   3.7983695796994963`*^9, 3.7983726254044905`*^9, 3.798373094854662*^9, 
   3.798373456520402*^9, 3.7983750657058115`*^9, 3.798375901057205*^9},
 CellLabel->
  "Out[328]=",ExpressionUUID->"48646abe-1db5-4ae0-9a26-17b2a97ffa8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FtmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "8"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FtErrmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "9"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FtErrmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"100", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"FtErrmapTriplets", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], "/", 
      RowBox[{"FtmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FtmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FtmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "/", 
      RowBox[{"Max", "[", 
       RowBox[{"FtmapTriplets", "[", 
        RowBox[{"[", 
         RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ftmap2lists", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"FtmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"FtmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "FtmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FtmapColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
        RowBox[{"FtmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"FtmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "FtmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FtmapErrColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], "}"}], 
         "]"}], "[", 
        RowBox[{
         RowBox[{"FtErrmapTriplets", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "/", "100"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"FtErrmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "FtErrmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FtmapVecs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"1.01", "rMoon", " ", 
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", 
         RowBox[{"2", ";;"}], ",", 
         RowBox[{"3", ";;", "5"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "rView"}], ",", "rView"}], "}"}], ",", "3"}], 
             "]"}]}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{
            "\"\<RELATIVE WEIGHT (BY DIVERGENCE AND DECAY) OF DETECTION \
EVENTS ORIGINATING\\n\\nEn at detector = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"Edetect", "[", 
                RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], "]"}], 
             "<>", "\"\< MeV\>\""}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", 
                RowBox[{"PointSize", "[", "0.003", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i", ",", 
                  RowBox[{"5", ";;", "7"}]}], "]"}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Gray", ",", 
                RowBox[{"PointSize", "[", "0.001", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"En", ",", "1", ",", 
                   RowBox[{"3", ";;", "5"}]}], "]"}], "]"}], "+", 
                RowBox[{"p", " ", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"En", ",", "i", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FmapColors", "[", 
               RowBox[{"[", 
                RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"FtmapVecs", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"FtmapVecs", "[", 
                RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
           "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Dhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Nhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Fhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Specularity", "[", 
             RowBox[{"White", ",", "100"}], "]"}], ",", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            "LightGray", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"Sphere", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "rMoon"}], 
             "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "360"}], ",", 
                 RowBox[{"-", "360"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                   "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Lon [deg]\>\"", ",", "\"\<Relative Intensity\>\""}], 
                   "}"}]}], "}"}]}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"BarLegend", "[", "\"\<Rainbow\>\"", "]"}], ",", 
                  "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                  RowBox[{"FtmapColors", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"LonLatRect5", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Ftmap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Ftmap2lists", "[", 
                   RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "360"}], ",", "360"}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                   "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Lon [deg]\>\"", ",", 
                    "\"\<Relative Std Err [x100%]\>\""}], "}"}]}], "}"}]}], 
               ",", 
               RowBox[{"PlotLegends", "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"BarLegend", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], 
                    "}"}], "]"}], "[", "#", "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
                  "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                  RowBox[{"FtmapErrColors", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"LonLatRect5", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Ftmap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Ftmap2lists", "[", 
                   RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{
             RowBox[{"FtmapTriplets", "[", 
              RowBox[{"[", "En", "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
               "}"}]}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Lon [deg]\>\"", ",", "\"\<Relative Intensity\>\""}], 
                 "}"}]}], "}"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}]}]}], "]"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{
             RowBox[{"FtErrmapTriplets", "[", 
              RowBox[{"[", "En", "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
               "}"}]}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Lon [deg]\>\"", ",", "\"\<Relative Std Err [%]\>\""}], 
                 "}"}]}], "}"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], 
                "}"}], "]"}]}]}], "]"}], "}"}]}], "\[IndentingNewLine]", 
         "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"En", ",", "1", ",", 
     RowBox[{"Length", "[", "c", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.798372665069878*^9, 3.798372685134992*^9}, {
   3.798372715583243*^9, 3.7983727173918076`*^9}, {3.7983728985051823`*^9, 
   3.7983728991995163`*^9}, {3.7983731172468944`*^9, 
   3.7983732276470284`*^9}, {3.798373346897111*^9, 3.7983733484625187`*^9}, 
   3.798373841057364*^9, {3.7983749087062817`*^9, 3.798374913919589*^9}, {
   3.7983758394424267`*^9, 3.7983758627516375`*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"e8989c70-803c-4247-a4fc-d7f90a608f77"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`En$$], 1, 15, 1}}, Typeset`size$$ = {
    1863., {322., 328.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`En$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Grid[{{
          Show[
           
           ListPointPlot3D[{}, PlotRange -> 
            Table[{-$CellContext`rView, $CellContext`rView}, 3], 
            BoxRatios -> {1, 1, 1}, ImageSize -> Large, PlotLabel -> 
            StringJoin[
             "RELATIVE WEIGHT (BY DIVERGENCE AND DECAY) OF DETECTION EVENTS \
ORIGINATING\n\nEn at detector = ", 
              ToString[
               Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
              " MeV"]], 
           Graphics3D[
            Table[{
              Directive[Black, 
               PointSize[0.003]], 
              Point[
               Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                Span[5, 7]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              Directive[Gray, 
               PointSize[0.001]], 
              Point[Part[$CellContext`a, $CellContext`En$$, 1, 
                 Span[3, 5]] + $CellContext`p 
                Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                  Span[1, 3]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              
              Part[$CellContext`FmapColors, $CellContext`En$$, \
$CellContext`i], 
              Point[
               
               Part[$CellContext`FtmapVecs, $CellContext`En$$, \
$CellContext`i]]}, {$CellContext`i, 1, 
              Length[
               Part[$CellContext`FtmapVecs, $CellContext`En$$]], 1}]], 
           Graphics3D[{Black, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Dhat}]}], 
           Graphics3D[{Blue, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Nhat}]}], 
           Graphics3D[{Red, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Fhat}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {1, 0, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 1, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 0, 1}}]}], 
           Graphics3D[{
             Specularity[White, 100], Lighting -> "Neutral", LightGray, 
             Opacity[1], 
             Sphere[{0, 0, 0}, $CellContext`rMoon]}]], 
          Grid[{{
             Show[
              
              ListPlot[{-360, -360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {
                 "Lon [deg]", "Relative Intensity"}}, PlotLegends -> Placed[
                 BarLegend["Rainbow"], Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`FtmapColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Ftmap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Ftmap2lists, $CellContext`En$$]], 1}]]}, {
             Show[
              
              ListPlot[{-360, 360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {
                 "Lon [deg]", "Relative Std Err [x100%]"}}, PlotLegends -> 
               Placed[
                 
                 BarLegend[{
                  ColorData[{"PigeonTones", "Reversed"}][#]& , {0, 1}}], 
                 Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`FtmapErrColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Ftmap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Ftmap2lists, $CellContext`En$$]], 1}]]}}], 
          
          Grid[{{
             ListDensityPlot[
              Part[$CellContext`FtmapTriplets, $CellContext`En$$], ImageSize -> 
              Large, PlotRange -> {{-180, 180}, {-90, 90}, Full}, AspectRatio -> 
              1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {
                "Lon [deg]", "Relative Intensity"}}, PlotLegends -> 
              Placed[Automatic, Left], ColorFunction -> 
              ColorData["Rainbow"]]}, {
             ListDensityPlot[
              Part[$CellContext`FtErrmapTriplets, $CellContext`En$$], 
              ImageSize -> Large, PlotRange -> {{-180, 180}, {-90, 90}, Full},
               AspectRatio -> 1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {
                "Lon [deg]", "Relative Std Err [%]"}}, PlotLegends -> 
              Placed[Automatic, Left], ColorFunction -> 
              ColorData[{"PigeonTones", "Reversed"}]]}}]}}], 
      "Specifications" :> {{$CellContext`En$$, 1, 15, 1, 
         Appearance -> {"Open"}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1914., {382., 388.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.798372720641769*^9, 3.7983732374608355`*^9, 3.7983734789360685`*^9, {
   3.798374885385361*^9, 3.7983749153551083`*^9}, 3.798375082335923*^9, 
   3.7983759059062457`*^9},
 CellLabel->
  "Out[337]=",ExpressionUUID->"a8fbb03e-6c9b-4904-9392-5f822a11f06b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"TmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "10"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tmax", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"TmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TErrmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "11"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TErrmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"100", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"TErrmapTriplets", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], "/", 
      RowBox[{"TmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "/", 
      RowBox[{"Max", "[", 
       RowBox[{"TmapTriplets", "[", 
        RowBox[{"[", 
         RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tmap2lists", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"TmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "TmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmapColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
        RowBox[{"TmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"TmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "TmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmapErrColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], "}"}], 
         "]"}], "[", 
        RowBox[{
         RowBox[{"TErrmapTriplets", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "/", "100"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"TErrmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "TErrmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmapVecs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"1.01", "rMoon", " ", 
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", 
         RowBox[{"2", ";;"}], ",", 
         RowBox[{"3", ";;", "5"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "rView"}], ",", "rView"}], "}"}], ",", "3"}], 
             "]"}]}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{
            "\"\<TIME OF FLIGHT OF DETECTION EVENTS ORIGINATING\\n\\nEn at \
detector = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"Edetect", "[", 
                RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], "]"}], 
             "<>", "\"\< MeV\>\""}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", 
                RowBox[{"PointSize", "[", "0.003", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i", ",", 
                  RowBox[{"5", ";;", "7"}]}], "]"}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Gray", ",", 
                RowBox[{"PointSize", "[", "0.001", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"En", ",", "1", ",", 
                   RowBox[{"3", ";;", "5"}]}], "]"}], "]"}], "+", 
                RowBox[{"p", " ", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"En", ",", "i", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"TmapColors", "[", 
               RowBox[{"[", 
                RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"TmapVecs", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"TmapVecs", "[", 
                RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
           "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Dhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Nhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Fhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Specularity", "[", 
             RowBox[{"White", ",", "100"}], "]"}], ",", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            "LightGray", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"Sphere", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "rMoon"}], 
             "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "360"}], ",", 
                 RowBox[{"-", "360"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                   "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Lon [deg]\>\"", ",", "\"\<TOF\>\""}], "}"}]}],
                  "}"}]}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"BarLegend", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Rainbow\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Tmax", "[", 
                    RowBox[{"[", "En", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                  ",", "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                  RowBox[{"TmapColors", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"LonLatRect5", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Tmap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Tmap2lists", "[", 
                   RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "360"}], ",", "360"}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                   "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Lon [deg]\>\"", ",", 
                    "\"\<Relative Std Err [x100%]\>\""}], "}"}]}], "}"}]}], 
               ",", 
               RowBox[{"PlotLegends", "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"BarLegend", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], 
                    "}"}], "]"}], "[", "#", "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
                  "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                  RowBox[{"TmapErrColors", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"LonLatRect5", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Tmap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Tmap2lists", "[", 
                   RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{
             RowBox[{"TmapTriplets", "[", 
              RowBox[{"[", "En", "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
               "}"}]}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Lon [deg]\>\"", ",", "\"\<TOF\>\""}], "}"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}]}]}], "]"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{
             RowBox[{"TErrmapTriplets", "[", 
              RowBox[{"[", "En", "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
               "}"}]}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Lon [deg]\>\"", ",", "\"\<Relative Std Err [%]\>\""}], 
                 "}"}]}], "}"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], 
                "}"}], "]"}]}]}], "]"}], "}"}]}], "\[IndentingNewLine]", 
         "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"En", ",", "1", ",", 
     RowBox[{"Length", "[", "c", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7983736552795086`*^9, 3.7983739429420033`*^9}, 
   3.79837494470817*^9, 3.7983749759054365`*^9, {3.7983751201146493`*^9, 
   3.7983751208490024`*^9}, {3.798375426147044*^9, 3.798375444639927*^9}, {
   3.79837548781016*^9, 3.798375545538266*^9}, {3.7983755819366403`*^9, 
   3.798375605872295*^9}, {3.798375645170517*^9, 3.798375646161217*^9}, {
   3.7983757670758667`*^9, 3.798375771650009*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"248f7b65-e5cc-4a22-9506-c3cff8a97e79"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`En$$], 1, 15, 1}}, Typeset`size$$ = {
    1886., {322., 328.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`En$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Grid[{{
          Show[
           
           ListPointPlot3D[{}, PlotRange -> 
            Table[{-$CellContext`rView, $CellContext`rView}, 3], 
            BoxRatios -> {1, 1, 1}, ImageSize -> Large, PlotLabel -> 
            StringJoin[
             "TIME OF FLIGHT OF DETECTION EVENTS ORIGINATING\n\nEn at \
detector = ", 
              ToString[
               Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
              " MeV"]], 
           Graphics3D[
            Table[{
              Directive[Black, 
               PointSize[0.003]], 
              Point[
               Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                Span[5, 7]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              Directive[Gray, 
               PointSize[0.001]], 
              Point[Part[$CellContext`a, $CellContext`En$$, 1, 
                 Span[3, 5]] + $CellContext`p 
                Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                  Span[1, 3]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              
              Part[$CellContext`TmapColors, $CellContext`En$$, \
$CellContext`i], 
              Point[
               
               Part[$CellContext`TmapVecs, $CellContext`En$$, \
$CellContext`i]]}, {$CellContext`i, 1, 
              Length[
               Part[$CellContext`TmapVecs, $CellContext`En$$]], 1}]], 
           Graphics3D[{Black, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Dhat}]}], 
           Graphics3D[{Blue, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Nhat}]}], 
           Graphics3D[{Red, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Fhat}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {1, 0, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 1, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 0, 1}}]}], 
           Graphics3D[{
             Specularity[White, 100], Lighting -> "Neutral", LightGray, 
             Opacity[1], 
             Sphere[{0, 0, 0}, $CellContext`rMoon]}]], 
          Grid[{{
             Show[
              
              ListPlot[{-360, -360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {"Lon [deg]", "TOF"}}, 
               PlotLegends -> Placed[
                 BarLegend[{"Rainbow", {0, 
                    Part[$CellContext`Tmax, $CellContext`En$$]}}], Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`TmapColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Tmap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Tmap2lists, $CellContext`En$$]], 1}]]}, {
             Show[
              
              ListPlot[{-360, 360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {
                 "Lon [deg]", "Relative Std Err [x100%]"}}, PlotLegends -> 
               Placed[
                 
                 BarLegend[{
                  ColorData[{"PigeonTones", "Reversed"}][#]& , {0, 1}}], 
                 Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`TmapErrColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Tmap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Tmap2lists, $CellContext`En$$]], 1}]]}}], 
          Grid[{{
             ListDensityPlot[
              Part[$CellContext`TmapTriplets, $CellContext`En$$], ImageSize -> 
              Large, PlotRange -> {{-180, 180}, {-90, 90}, Full}, AspectRatio -> 
              1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {"Lon [deg]", "TOF"}}, 
              PlotLegends -> Placed[Automatic, Left], ColorFunction -> 
              ColorData["Rainbow"]]}, {
             ListDensityPlot[
              Part[$CellContext`TErrmapTriplets, $CellContext`En$$], 
              ImageSize -> Large, PlotRange -> {{-180, 180}, {-90, 90}, Full},
               AspectRatio -> 1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {
                "Lon [deg]", "Relative Std Err [%]"}}, PlotLegends -> 
              Placed[Automatic, Left], ColorFunction -> 
              ColorData[{"PigeonTones", "Reversed"}]]}}]}}], 
      "Specifications" :> {{$CellContext`En$$, 1, 15, 1, 
         Appearance -> {"Open"}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1937., {382., 388.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7983739445572157`*^9, {3.798375098883518*^9, 3.798375122636574*^9}, 
   3.7983754495856442`*^9, 3.7983756083610363`*^9, 3.798375647691959*^9, 
   3.7983757729996047`*^9, 3.798375910638596*^9},
 CellLabel->
  "Out[347]=",ExpressionUUID->"f3fb11aa-f9fc-48af-96ef-1030a5ee681f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "12"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Emax", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"EmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EErrmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "13"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EErrmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"100", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"EErrmapTriplets", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], "/", 
      RowBox[{"EmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"EmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "/", 
      RowBox[{"Max", "[", 
       RowBox[{"EmapTriplets", "[", 
        RowBox[{"[", 
         RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Emap2lists", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"EmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"EmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "EmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmapColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
        RowBox[{"EmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"EmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "EmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmapErrColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], "}"}], 
         "]"}], "[", 
        RowBox[{
         RowBox[{"EErrmapTriplets", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "/", "100"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"EErrmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "EErrmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmapVecs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"1.01", "rMoon", " ", 
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", 
         RowBox[{"2", ";;"}], ",", 
         RowBox[{"3", ";;", "5"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "rView"}], ",", "rView"}], "}"}], ",", "3"}], 
             "]"}]}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{
            "\"\<EMISSION ENERGY OF DETECTION EVENTS ORIGINATING\\n\\nEn at \
detector = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"Edetect", "[", 
                RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], "]"}], 
             "<>", "\"\< MeV\>\""}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", 
                RowBox[{"PointSize", "[", "0.003", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i", ",", 
                  RowBox[{"5", ";;", "7"}]}], "]"}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Gray", ",", 
                RowBox[{"PointSize", "[", "0.001", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"En", ",", "1", ",", 
                   RowBox[{"3", ";;", "5"}]}], "]"}], "]"}], "+", 
                RowBox[{"p", " ", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"En", ",", "i", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"EmapColors", "[", 
               RowBox[{"[", 
                RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"EmapVecs", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"EmapVecs", "[", 
                RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
           "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Dhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Nhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Fhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Specularity", "[", 
             RowBox[{"White", ",", "100"}], "]"}], ",", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            "LightGray", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"Sphere", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "rMoon"}], 
             "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "360"}], ",", 
                 RowBox[{"-", "360"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                   "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Lon [deg]\>\"", ",", "\"\<Ee\>\""}], "}"}]}], 
                 "}"}]}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"BarLegend", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Rainbow\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Emax", "[", 
                    RowBox[{"[", "En", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                  ",", "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                  RowBox[{"EmapColors", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"LonLatRect5", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Emap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Emap2lists", "[", 
                   RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "360"}], ",", "360"}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                   "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Lon [deg]\>\"", ",", 
                    "\"\<Relative Std Err [x100%]\>\""}], "}"}]}], "}"}]}], 
               ",", 
               RowBox[{"PlotLegends", "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"BarLegend", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], 
                    "}"}], "]"}], "[", "#", "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
                  "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                  RowBox[{"EmapErrColors", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"LonLatRect5", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Emap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Emap2lists", "[", 
                   RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{
             RowBox[{"EmapTriplets", "[", 
              RowBox[{"[", "En", "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
               "}"}]}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Lon [deg]\>\"", ",", "\"\<Ee\>\""}], "}"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}]}]}], "]"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{
             RowBox[{"EErrmapTriplets", "[", 
              RowBox[{"[", "En", "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
               "}"}]}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Lon [deg]\>\"", ",", "\"\<Relative Std Err [%]\>\""}], 
                 "}"}]}], "}"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], 
                "}"}], "]"}]}]}], "]"}], "}"}]}], "\[IndentingNewLine]", 
         "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"En", ",", "1", ",", 
     RowBox[{"Length", "[", "c", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7983742149113927`*^9, 3.7983744113277464`*^9}, 
   3.798374956290992*^9, {3.7983759511711845`*^9, 3.7983760107845416`*^9}, {
   3.798376247827815*^9, 3.798376268048216*^9}},
 CellLabel->
  "In[378]:=",ExpressionUUID->"79314a24-6c0f-4759-9940-05e697d0ea0a"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`En$$], 1, 15, 1}}, Typeset`size$$ = {
    1893., {322., 328.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`En$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Grid[{{
          Show[
           
           ListPointPlot3D[{}, PlotRange -> 
            Table[{-$CellContext`rView, $CellContext`rView}, 3], 
            BoxRatios -> {1, 1, 1}, ImageSize -> Large, PlotLabel -> 
            StringJoin[
             "EMISSION ENERGY OF DETECTION EVENTS ORIGINATING\n\nEn at \
detector = ", 
              ToString[
               Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
              " MeV"]], 
           Graphics3D[
            Table[{
              Directive[Black, 
               PointSize[0.003]], 
              Point[
               Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                Span[5, 7]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              Directive[Gray, 
               PointSize[0.001]], 
              Point[Part[$CellContext`a, $CellContext`En$$, 1, 
                 Span[3, 5]] + $CellContext`p 
                Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                  Span[1, 3]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              
              Part[$CellContext`EmapColors, $CellContext`En$$, \
$CellContext`i], 
              Point[
               
               Part[$CellContext`EmapVecs, $CellContext`En$$, \
$CellContext`i]]}, {$CellContext`i, 1, 
              Length[
               Part[$CellContext`EmapVecs, $CellContext`En$$]], 1}]], 
           Graphics3D[{Black, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Dhat}]}], 
           Graphics3D[{Blue, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Nhat}]}], 
           Graphics3D[{Red, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Fhat}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {1, 0, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 1, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 0, 1}}]}], 
           Graphics3D[{
             Specularity[White, 100], Lighting -> "Neutral", LightGray, 
             Opacity[1], 
             Sphere[{0, 0, 0}, $CellContext`rMoon]}]], 
          Grid[{{
             Show[
              
              ListPlot[{-360, -360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {"Lon [deg]", "Ee"}}, 
               PlotLegends -> Placed[
                 BarLegend[{"Rainbow", {0, 
                    Part[$CellContext`Emax, $CellContext`En$$]}}], Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`EmapColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Emap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Emap2lists, $CellContext`En$$]], 1}]]}, {
             Show[
              
              ListPlot[{-360, 360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {
                 "Lon [deg]", "Relative Std Err [x100%]"}}, PlotLegends -> 
               Placed[
                 
                 BarLegend[{
                  ColorData[{"PigeonTones", "Reversed"}][#]& , {0, 1}}], 
                 Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`EmapErrColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Emap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Emap2lists, $CellContext`En$$]], 1}]]}}], 
          Grid[{{
             ListDensityPlot[
              Part[$CellContext`EmapTriplets, $CellContext`En$$], ImageSize -> 
              Large, PlotRange -> {{-180, 180}, {-90, 90}, Full}, AspectRatio -> 
              1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {"Lon [deg]", "Ee"}}, 
              PlotLegends -> Placed[Automatic, Left], ColorFunction -> 
              ColorData["Rainbow"]]}, {
             ListDensityPlot[
              Part[$CellContext`EErrmapTriplets, $CellContext`En$$], 
              ImageSize -> Large, PlotRange -> {{-180, 180}, {-90, 90}, Full},
               AspectRatio -> 1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {
                "Lon [deg]", "Relative Std Err [%]"}}, PlotLegends -> 
              Placed[Automatic, Left], ColorFunction -> 
              ColorData[{"PigeonTones", "Reversed"}]]}}]}}], 
      "Specifications" :> {{$CellContext`En$$, 1, 15, 1, 
         Appearance -> {"Open"}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1944., {382., 388.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.7983743724689727`*^9, 3.7983744131294684`*^9, 
  3.7983751543997517`*^9, 3.7983759154451656`*^9, 3.7983760141516776`*^9, 
  3.798376269660488*^9},
 CellLabel->
  "Out[387]=",ExpressionUUID->"ee0c0284-5a42-44bd-b216-15fc613312b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "14"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmax", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"DmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DErrmapTriplets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"[", 
       RowBox[{"En", ",", 
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "15"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DErrmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"100", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DErrmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "/", 
      RowBox[{"DmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DmapTriplets", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DmapTriplets", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "/", 
      RowBox[{"Max", "[", 
       RowBox[{"DmapTriplets", "[", 
        RowBox[{"[", 
         RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmap2lists", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"DmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "DmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DmapColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
        RowBox[{"DmapTriplets", "[", 
         RowBox[{"[", 
          RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"DmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "DmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DmapErrColors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], "}"}], 
         "]"}], "[", 
        RowBox[{
         RowBox[{"DErrmapTriplets", "[", 
          RowBox[{"[", 
           RowBox[{"En", ",", "i", ",", "3"}], "]"}], "]"}], "/", "100"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"DErrmapTriplets", "[", 
           RowBox[{"[", 
            RowBox[{"En", ",", ";;", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "DErrmapTriplets", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DmapVecs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"1.01", "rMoon", " ", 
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"En", ",", 
         RowBox[{"2", ";;"}], ",", 
         RowBox[{"3", ";;", "5"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"En", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "rView"}], ",", "rView"}], "}"}], ",", "3"}], 
             "]"}]}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{
            "\"\<DIVERGENCE AFTER EMISSION OF DETECTION EVENTS ORIGINATING\\n\
\\nEn at detector = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"Edetect", "[", 
                RowBox[{"[", "En", "]"}], "]"}], ",", "FortranForm"}], "]"}], 
             "<>", "\"\< MeV\>\""}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", 
                RowBox[{"PointSize", "[", "0.003", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i", ",", 
                  RowBox[{"5", ";;", "7"}]}], "]"}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Gray", ",", 
                RowBox[{"PointSize", "[", "0.001", "]"}]}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"En", ",", "1", ",", 
                   RowBox[{"3", ";;", "5"}]}], "]"}], "]"}], "+", 
                RowBox[{"p", " ", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"En", ",", "i", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", "1"}], 
             "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DmapColors", "[", 
               RowBox[{"[", 
                RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"DmapVecs", "[", 
                RowBox[{"[", 
                 RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"DmapVecs", "[", 
                RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
           "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Dhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Nhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Arrowheads", "[", ".01", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"Rsat", ",", 
               RowBox[{"Rsat", "+", 
                RowBox[{".15", "rView", " ", "Fhat"}]}]}], "}"}], "]"}]}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"origin", ",", 
               RowBox[{"0.9", "rView", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Specularity", "[", 
             RowBox[{"White", ",", "100"}], "]"}], ",", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            "LightGray", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"Sphere", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "rMoon"}], 
             "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "360"}], ",", 
                 RowBox[{"-", "360"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                   "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Lon [deg]\>\"", ",", "\"\<DF\>\""}], "}"}]}], 
                 "}"}]}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"BarLegend", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Rainbow\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Dmax", "[", 
                    RowBox[{"[", "En", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                  ",", "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                  RowBox[{"DmapColors", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"LonLatRect5", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Dmap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Dmap2lists", "[", 
                   RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "360"}], ",", "360"}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                   "]"}]}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"latTicks", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Lat [deg]\>\"", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Lon [deg]\>\"", ",", 
                    "\"\<Relative Std Err [x100%]\>\""}], "}"}]}], "}"}]}], 
               ",", 
               RowBox[{"PlotLegends", "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"BarLegend", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], 
                    "}"}], "]"}], "[", "#", "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
                  "Left"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Gray"}], "}"}], "]"}], ",", 
                  RowBox[{"DmapErrColors", "[", 
                   RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"LonLatRect5", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Dmap2lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"En", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Dmap2lists", "[", 
                   RowBox[{"[", "En", "]"}], "]"}], "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{
             RowBox[{"DmapTriplets", "[", 
              RowBox[{"[", "En", "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
               "}"}]}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Lon [deg]\>\"", ",", "\"\<DF\>\""}], "}"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}]}]}], "]"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{
             RowBox[{"DErrmapTriplets", "[", 
              RowBox[{"[", "En", "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", "Full"}], 
               "}"}]}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "180"}], ",", "180", ",", "5"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "5"}], "}"}]}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "latTicks"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lonTicks", ",", "None"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "\"\<Lat [deg]\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Lon [deg]\>\"", ",", "\"\<Relative Std Err [%]\>\""}], 
                 "}"}]}], "}"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"Automatic", ",", "Left"}], "]"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<PigeonTones\>\"", ",", "\"\<Reversed\>\""}], 
                "}"}], "]"}]}]}], "]"}], "}"}]}], "\[IndentingNewLine]", 
         "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"En", ",", "1", ",", 
     RowBox[{"Length", "[", "c", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\"\<Open\>\"", "}"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.798374460031086*^9, 3.798374534783352*^9}, {
   3.798374588031539*^9, 3.7983747166374645`*^9}, 3.7983749636663675`*^9, {
   3.798376473477228*^9, 3.798376527936368*^9}},
 CellLabel->
  "In[388]:=",ExpressionUUID->"98b75c15-a9af-4d6d-b1fb-4d26eafe9d46"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`En$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`En$$], 1, 15, 1}}, Typeset`size$$ = {
    1887., {322., 328.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`En$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Grid[{{
          Show[
           
           ListPointPlot3D[{}, PlotRange -> 
            Table[{-$CellContext`rView, $CellContext`rView}, 3], 
            BoxRatios -> {1, 1, 1}, ImageSize -> Large, PlotLabel -> 
            StringJoin[
             "DIVERGENCE AFTER EMISSION OF DETECTION EVENTS ORIGINATING\n\nEn \
at detector = ", 
              ToString[
               Part[$CellContext`Edetect, $CellContext`En$$], FortranForm], 
              " MeV"]], 
           Graphics3D[
            Table[{
              Directive[Black, 
               PointSize[0.003]], 
              Point[
               Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                Span[5, 7]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              Directive[Gray, 
               PointSize[0.001]], 
              Point[Part[$CellContext`a, $CellContext`En$$, 1, 
                 Span[3, 5]] + $CellContext`p 
                Part[$CellContext`a, $CellContext`En$$, $CellContext`i, 
                  Span[1, 3]]]}, {$CellContext`i, 2, 
              Length[
               Part[$CellContext`a, $CellContext`En$$, 
                Span[2, All]]], 1}]], 
           Graphics3D[
            Table[{
              
              Part[$CellContext`DmapColors, $CellContext`En$$, \
$CellContext`i], 
              Point[
               
               Part[$CellContext`DmapVecs, $CellContext`En$$, \
$CellContext`i]]}, {$CellContext`i, 1, 
              Length[
               Part[$CellContext`DmapVecs, $CellContext`En$$]], 1}]], 
           Graphics3D[{Black, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Dhat}]}], 
           Graphics3D[{Blue, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Nhat}]}], 
           Graphics3D[{Red, 
             Arrowheads[0.01], 
             
             Arrow[{$CellContext`Rsat, $CellContext`Rsat + 
               0.15 $CellContext`rView $CellContext`Fhat}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {1, 0, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 1, 0}}]}], 
           Graphics3D[{LightGray, 
             Arrowheads[0.02], 
             Arrow[{$CellContext`origin, 0.9 $CellContext`rView {0, 0, 1}}]}], 
           Graphics3D[{
             Specularity[White, 100], Lighting -> "Neutral", LightGray, 
             Opacity[1], 
             Sphere[{0, 0, 0}, $CellContext`rMoon]}]], 
          Grid[{{
             Show[
              
              ListPlot[{-360, -360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {"Lon [deg]", "DF"}}, 
               PlotLegends -> Placed[
                 BarLegend[{"Rainbow", {0, 
                    Part[$CellContext`Dmax, $CellContext`En$$]}}], Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`DmapColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Dmap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Dmap2lists, $CellContext`En$$]], 1}]]}, {
             Show[
              
              ListPlot[{-360, 360}, ImageSize -> Large, 
               PlotRange -> {{-180, 180}, {-90, 90}}, AspectRatio -> 1/2, 
               GridLines -> {
                 Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                 Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
               True, FrameStyle -> Black, 
               FrameTicks -> {{$CellContext`latTicks, 
                  None}, {$CellContext`lonTicks, None}}, 
               FrameLabel -> {{"Lat [deg]", None}, {
                 "Lon [deg]", "Relative Std Err [x100%]"}}, PlotLegends -> 
               Placed[
                 
                 BarLegend[{
                  ColorData[{"PigeonTones", "Reversed"}][#]& , {0, 1}}], 
                 Left]], 
              Table[
               Graphics[{
                 EdgeForm[{Thin, Gray}], 
                 
                 Part[$CellContext`DmapErrColors, $CellContext`En$$, \
$CellContext`i], 
                 $CellContext`LonLatRect5[
                  Flatten[
                   
                   Part[$CellContext`Dmap2lists, $CellContext`En$$, \
$CellContext`i]]]}], {$CellContext`i, 1, 
                Length[
                 Part[$CellContext`Dmap2lists, $CellContext`En$$]], 1}]]}}], 
          Grid[{{
             ListDensityPlot[
              Part[$CellContext`DmapTriplets, $CellContext`En$$], ImageSize -> 
              Large, PlotRange -> {{-180, 180}, {-90, 90}, Full}, AspectRatio -> 
              1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {"Lon [deg]", "DF"}}, 
              PlotLegends -> Placed[Automatic, Left], ColorFunction -> 
              ColorData["Rainbow"]]}, {
             ListDensityPlot[
              Part[$CellContext`DErrmapTriplets, $CellContext`En$$], 
              ImageSize -> Large, PlotRange -> {{-180, 180}, {-90, 90}, Full},
               AspectRatio -> 1/2, GridLines -> {
                Table[$CellContext`i, {$CellContext`i, -180, 180, 5}], 
                Table[$CellContext`i, {$CellContext`i, -90, 90, 5}]}, Frame -> 
              True, FrameStyle -> Black, 
              FrameTicks -> {{
                None, $CellContext`latTicks}, {$CellContext`lonTicks, None}}, 
              FrameLabel -> {{None, "Lat [deg]"}, {
                "Lon [deg]", "Relative Std Err [%]"}}, PlotLegends -> 
              Placed[Automatic, Left], ColorFunction -> 
              ColorData[{"PigeonTones", "Reversed"}]]}}]}}], 
      "Specifications" :> {{$CellContext`En$$, 1, 15, 1, 
         Appearance -> {"Open"}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1938., {382., 388.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7983747085790033`*^9, 3.798374718561265*^9}, 
   3.798375167262355*^9, 3.798375920494405*^9, 3.7983765323357177`*^9},
 CellLabel->
  "Out[397]=",ExpressionUUID->"d7302a82-49f6-4cad-a115-f73e3a9ac312"]
}, Open  ]]
},
WindowSize->{2560, 1007},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5bacc4d9-5684-4201-8fb6-89c8d364033d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 302, 6, 28, "Input",ExpressionUUID->"b60bcda4-b1a2-4102-8600-9d2e8b60307c"],
Cell[885, 30, 644, 10, 32, "Output",ExpressionUUID->"11d41d6a-833a-4f83-b4fe-9db273bcf638"]
}, Open  ]],
Cell[1544, 43, 8265, 202, 1211, "Input",ExpressionUUID->"9dbb198b-91d6-48fd-ba27-3ecc46c43c0a"],
Cell[9812, 247, 4629, 134, 295, "Input",ExpressionUUID->"9278cff5-a626-40ea-b990-31a59825014f"],
Cell[CellGroupData[{
Cell[14466, 385, 21841, 486, 941, "Input",ExpressionUUID->"15bf1efb-2181-49b5-b420-56479a96a331"],
Cell[36310, 873, 9501, 210, 831, "Output",ExpressionUUID->"ff83ceb7-7b74-4cfa-bd3f-f26feeb0ae77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45848, 1088, 6298, 155, 200, "Input",ExpressionUUID->"df1190f4-06a7-4325-a642-7fbde80f39ae"],
Cell[52149, 1245, 2585, 50, 477, "Output",ExpressionUUID->"9d866eec-863a-448a-afc7-4abb91599b28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54771, 1300, 4486, 120, 226, "Input",ExpressionUUID->"62e629e0-eb67-45ec-bb1d-b0a47eb72723"],
Cell[59260, 1422, 2924, 59, 467, "Output",ExpressionUUID->"928de7be-e050-41c0-9bf0-d5f6a3c4c78e"]
}, Open  ]],
Cell[62199, 1484, 867, 27, 86, "Input",ExpressionUUID->"8e644a2f-8674-48d6-ab91-8e73c256e1b4"],
Cell[CellGroupData[{
Cell[63091, 1515, 17391, 428, 637, "Input",ExpressionUUID->"2ea91080-3649-4ade-acf4-d4f619ab0bdf"],
Cell[80485, 1945, 6717, 150, 769, "Output",ExpressionUUID->"d179013f-b23d-4d48-9ab4-03ce2bb1a288"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87239, 2100, 29971, 692, 827, "Input",ExpressionUUID->"a899b1e0-f61c-4884-a3ed-fcfed9c9b4d4"],
Cell[117213, 2794, 9359, 200, 789, "Output",ExpressionUUID->"48646abe-1db5-4ae0-9a26-17b2a97ffa8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126609, 2999, 25994, 638, 827, "Input",ExpressionUUID->"e8989c70-803c-4247-a4fc-d7f90a608f77"],
Cell[152606, 3639, 8690, 192, 789, "Output",ExpressionUUID->"a8fbb03e-6c9b-4904-9392-5f822a11f06b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161333, 3836, 26525, 654, 846, "Input",ExpressionUUID->"248f7b65-e5cc-4a22-9506-c3cff8a97e79"],
Cell[187861, 4492, 8687, 191, 789, "Output",ExpressionUUID->"f3fb11aa-f9fc-48af-96ef-1030a5ee681f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196585, 4688, 26302, 651, 846, "Input",ExpressionUUID->"79314a24-6c0f-4759-9940-05e697d0ea0a"],
Cell[222890, 5341, 8637, 190, 810, "Output",ExpressionUUID->"ee0c0284-5a42-44bd-b216-15fc613312b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[231564, 5536, 26271, 650, 846, "Input",ExpressionUUID->"98b75c15-a9af-4d6d-b1fb-4d26eafe9d46"],
Cell[257838, 6188, 8619, 189, 789, "Output",ExpressionUUID->"d7302a82-49f6-4cad-a115-f73e3a9ac312"]
}, Open  ]]
}
]
*)

